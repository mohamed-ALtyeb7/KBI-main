(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,46897,e=>{"use strict";let t=(0,e.i(75254).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>t],46897)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],3116)},26707,e=>{"use strict";let t=(0,e.i(75254).default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);e.s(["Smartphone",()=>t],26707)},69638,6321,e=>{"use strict";let t=(0,e.i(75254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>t],6321),e.s(["CheckCircle",()=>t],69638)},87486,e=>{"use strict";var t=e.i(43476),r=e.i(91918),a=e.i(25913),s=e.i(75157);let i=(0,a.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:a,asChild:n=!1,...o}){let l=n?r.Slot:"span";return(0,t.jsx)(l,{"data-slot":"badge",className:(0,s.cn)(i({variant:a}),e),...o})}e.s(["Badge",()=>n])},15288,e=>{"use strict";var t=e.i(43476),r=e.i(75157);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function s({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>n,"CardHeader",()=>s,"CardTitle",()=>i])},18071,e=>{"use strict";var t=e.i(83814);function r(){let{lang:e,setLang:r}=(0,t.useLanguage)();return{language:e,setLanguage:r,t:(0,t.useT)()}}e.s(["useLanguage",()=>r])},86118,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(11605);async function a(e){try{let a=(await (0,t.getDoc)((0,t.doc)(r.db,"users",e.uid))).data(),s=a?.technicianId||null;if(!s){let a=(0,t.query)((0,t.collection)(r.db,"technicians"),(0,t.where)("uid","==",e.uid)),i=await (0,t.getDocs)(a);if(i.empty){if(e.email){let a=(0,t.query)((0,t.collection)(r.db,"technicians"),(0,t.where)("email","==",e.email)),i=await (0,t.getDocs)(a);i.empty||(s=i.docs[0].id)}}else s=i.docs[0].id}return s}catch(e){return console.error("Resolve technicianId error:",e),null}}e.s(["getTechnicianIdFromUser",()=>a])},39312,e=>{"use strict";let t=(0,e.i(75254).default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);e.s(["Zap",()=>t],39312)},21218,e=>{"use strict";let t=(0,e.i(75254).default)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);e.s(["Activity",()=>t],21218)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);e.s(["TrendingUp",()=>t],25652)},24687,e=>{"use strict";var t=e.i(43476),r=e.i(75157);function a({className:e,...a}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}e.s(["Textarea",()=>a])},70273,e=>{"use strict";let t=(0,e.i(75254).default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],70273)},25324,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(11605);async function a(e){return(await (0,t.addDoc)((0,t.collection)(r.db,"notifications"),{...e,read:!1,createdAt:t.Timestamp.now()})).id}async function s(e,a){try{await (0,t.updateDoc)((0,t.doc)(r.db,"orders",e),{...a,updatedAt:(0,t.serverTimestamp)()})}catch(e){throw console.error("Update order error:",e),Error(e.message||"Failed to update order")}}async function i(e,r){let i=r.proposedBreakdown?Number(r.proposedBreakdown.labor||0)+Number(r.proposedBreakdown.parts||0)+Number(r.proposedBreakdown.inspection||0):null,n=r.proposedPriceMax??r.proposedPriceMin??null,o=i??n??null,l=t.Timestamp.fromDate(new Date(Date.now()+1728e5)),d={proposedPrice:r.proposedPriceMax??r.proposedPriceMin??null,proposedPriceMin:r.proposedPriceMin??null,proposedPriceMax:r.proposedPriceMax??null,proposedBreakdown:r.proposedBreakdown??null,proposedDurationMinutes:r.proposedDurationMinutes,proposedArrivalETA:r.proposedArrivalETA??null,proposalNote:r.proposalNote||null,proposalMediaUrls:r.proposalMediaUrls||null,proposedByTechnicianId:r.proposedByTechnicianId,proposedAt:(0,t.serverTimestamp)(),proposedExpiresAt:l,pricingStatus:"proposed"};await s(e,d);try{let t=`Technician proposed pricing for order ${e}`+(null!=o?` • AED ${o}`:"");await a({type:"system",title:"Pricing Proposed",message:t,role:"admin",orderId:e,link:"/admin/orders"}),null!=o&&o>500?await a({type:"system",title:"High-Value Proposal",message:`Order ${e} requires Super Admin review • AED ${o}`,role:"super_admin",orderId:e,link:"/admin/orders"}):null!=o&&o<200&&await a({type:"system",title:"Auto-Approval Candidate",message:`Order ${e} proposed under AED 200 • Consider auto-approve`,role:"admin",orderId:e,link:"/admin/orders"})}catch(e){}}async function n(e,i){let n=await (0,t.getDoc)((0,t.doc)(r.db,"orders",e));if(!n.exists())return;let o=n.data(),l={approvedPrice:o.proposedBreakdown?Number(o.proposedBreakdown.labor||0)+Number(o.proposedBreakdown.parts||0)+Number(o.proposedBreakdown.inspection||0):o.proposedPriceMax??o.proposedPrice??null,approvedDurationMinutes:o.proposedDurationMinutes??null,approvedArrivalETA:o.proposedArrivalETA??null,approvedByAdminId:i,approvedAt:(0,t.serverTimestamp)(),pricingStatus:"approved"};await s(e,l);try{await a({type:"system",title:"Pricing Approved",message:`Pricing approved for order ${e}`,role:"technician",orderId:e,link:"/technician/orders"})}catch(e){}}async function o(e){await s(e,{pricingStatus:"rejected"});try{await a({type:"system",title:"Pricing Rejected",message:`Pricing rejected for order ${e}`,role:"technician",orderId:e,link:"/technician/orders"})}catch(e){}}async function l(e,r,i){let n={counterPrice:i.counterPrice??null,counterDurationMinutes:i.counterDurationMinutes??null,counterArrivalETA:i.counterArrivalETA??null,approvedByAdminId:r,counterByAdminId:r,counterAt:(0,t.serverTimestamp)(),pricingStatus:"countered",proposalNote:i.counterNote??null};await s(e,n);try{await a({type:"system",title:"Counter Offer",message:`Counter offer posted for order ${e}`,role:"technician",orderId:e,link:"/technician/orders"})}catch(e){}}async function d(e,a){let i=(0,t.doc)(r.db,"orders",e),n=await (0,t.getDoc)(i);if(!n.exists())throw Error("Order not found");let o=n.data();if("assigned"!==o.status||o.technicianId&&o.technicianId!==a)throw Error("Not allowed to accept");await s(e,{status:"accepted"})}async function c(e,i){let n=(0,t.doc)(r.db,"orders",e),o=await (0,t.getDoc)(n);if(!o.exists())throw Error("Order not found");let l=o.data();if("countered"!==l.pricingStatus||l.technicianId&&l.technicianId!==i)throw Error("Not allowed to re-accept");await s(e,{pricingStatus:"re_accepted"});try{await a({type:"system",title:"Counter Offer Accepted",message:`Technician accepted counter offer for order ${e}`,role:"admin",orderId:e,link:"/admin/orders"})}catch(e){}}async function p(e,a){let i=(0,t.doc)(r.db,"orders",e),n=await (0,t.getDoc)(i);if(!n.exists())throw Error("Order not found");let o=n.data();if("approved"!==o.pricingStatus||o.technicianId&&o.technicianId!==a)throw Error("Cannot start work");await s(e,{status:"in_progress"})}e.s(["acceptAssignedOrder",()=>d,"approveOrderPricing",()=>n,"counterOfferPricing",()=>l,"proposeOrderPricing",()=>i,"reAcceptCounterOffer",()=>c,"rejectOrderPricing",()=>o,"startWork",()=>p],25324)},26919,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(15288),s=e.i(1928),i=e.i(3116),n=e.i(6321),n=n,o=e.i(21218),l=e.i(87316),d=e.i(46897),c=e.i(26707);e.i(36180);var p=e.i(98925),u=e.i(11605),h=e.i(18071),x=e.i(18566),g=e.i(19455),m=e.i(87486),w=e.i(70273),b=e.i(69638),f=e.i(25652),v=e.i(39312),y=e.i(75157);function j({technicianId:e}){let[s,i]=(0,r.useState)({totalJobs:0,completedToday:0,avgRating:0,avgRepairTime:0,earningsToday:0,earningsWeek:0}),[n,o]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{if(e)try{if(u.isMockMode){i({totalJobs:0,completedToday:0,avgRating:0,avgRepairTime:0,earningsToday:0,earningsWeek:0}),o(!1);return}let t=(0,p.query)((0,p.collection)(u.db,"orders"),(0,p.where)("technicianId","==",e)),r=await (0,p.getDocs)(t),a=new Date;a.setHours(0,0,0,0);let s=new Date(a);s.setDate(s.getDate()-7);let n=0,l=0,d=0,c=0,h=0,x=0,g=0;r.docs.forEach(e=>{let t=e.data(),r=t.createdAt?.toDate?.()||new Date(t.createdAt);if(t.rating?.score&&(n+=t.rating.score,l++),"completed"===t.status||"delivered"===t.status){let e=t.price||0;r>=a&&(g++,h+=e),r>=s&&(x+=e),t.repairTime&&(d+=t.repairTime,c++)}}),i({totalJobs:r.docs.length,completedToday:g,avgRating:l>0?n/l:0,avgRepairTime:c>0?Math.round(d/c):0,earningsToday:h,earningsWeek:x})}catch(e){y.logger.error("Failed to fetch tech stats:",e)}finally{o(!1)}})()},[e]),n)?(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 animate-pulse",children:[void 0,void 0,void 0,void 0].map((e,r)=>(0,t.jsx)(a.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(a.CardContent,{className:"p-4 h-20"})},r))}):(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,t.jsx)(a.Card,{className:"bg-gradient-to-br from-green-500/10 to-emerald-500/10 border-green-500/20",children:(0,t.jsxs)(a.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(f.TrendingUp,{className:"w-4 h-4 text-green-400"}),(0,t.jsx)("span",{className:"text-xs text-green-400/70",children:"Today's Earnings"})]}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-green-400",children:[s.earningsToday.toLocaleString()," ",(0,t.jsx)("span",{className:"text-sm font-normal",children:"AED"})]})]})}),(0,t.jsx)(a.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsxs)(a.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(b.CheckCircle,{className:"w-4 h-4 text-cyan-400"}),(0,t.jsx)("span",{className:"text-xs text-white/50",children:"Completed Today"})]}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-white",children:[s.completedToday," ",(0,t.jsx)("span",{className:"text-sm font-normal text-white/50",children:"jobs"})]})]})}),(0,t.jsx)(a.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsxs)(a.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(w.Star,{className:"w-4 h-4 text-yellow-400"}),(0,t.jsx)("span",{className:"text-xs text-white/50",children:"Avg Rating"})]}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-white",children:[s.avgRating>0?s.avgRating.toFixed(1):"—",(0,t.jsx)("span",{className:"text-sm font-normal text-white/50",children:"/5"})]})]})}),(0,t.jsx)(a.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsxs)(a.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(v.Zap,{className:"w-4 h-4 text-purple-400"}),(0,t.jsx)("span",{className:"text-xs text-white/50",children:"Week Earnings"})]}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-white",children:[s.earningsWeek.toLocaleString()," ",(0,t.jsx)("span",{className:"text-sm font-normal text-white/50",children:"AED"})]})]})})]})}var N=e.i(86118),C=e.i(93479),k=e.i(24687),A=e.i(67489),S=e.i(25324);e.i(61086);var T=e.i(27215);function M(){let{t:e,language:w}=(0,h.useLanguage)(),b=(0,x.useRouter)(),[f,v]=(0,r.useState)(!0),[M,P]=(0,r.useState)({activeJobs:0,completedToday:0,totalAssigned:0,pending:0}),[D,B]=(0,r.useState)([]),[I,E]=(0,r.useState)(null),[_,O]=(0,r.useState)([]),[R,L]=(0,r.useState)(null),[U,$]=(0,r.useState)(null),[F,H]=(0,r.useState)(""),[q,z]=(0,r.useState)("minutes"),[W,J]=(0,r.useState)(""),[V,Z]=(0,r.useState)(""),[K,G]=(0,r.useState)("range"),[Q,X]=(0,r.useState)(""),[Y,ee]=(0,r.useState)(""),[et,er]=(0,r.useState)(""),[ea,es]=(0,r.useState)(""),[ei,en]=(0,r.useState)(""),[eo,el]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e=u.auth.onAuthStateChanged(e=>{E(e)});return()=>e()},[]),(0,r.useEffect)(()=>{I&&(async()=>{L(await (0,N.getTechnicianIdFromUser)({uid:I.uid,email:I.email||void 0}))})()},[I]),(0,r.useEffect)(()=>{if(!I?.uid)return;if(u.isMockMode){B([]),P({activeJobs:0,completedToday:0,totalAssigned:0,pending:0}),v(!1);return}v(!0);let e=(0,p.collection)(u.db,"orders"),t=(0,p.query)(e,(0,p.where)("technicianId","==",I.uid),(0,p.orderBy)("createdAt","desc")),r=(0,p.onSnapshot)(t,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));B(t);let r=t.filter(e=>["in_progress","on_way","pending"].includes(e.status)).length,a=new Date().toISOString().split("T")[0];P({activeJobs:r,completedToday:t.filter(e=>"completed"===e.status&&e.updatedAt?.toDate?.().toISOString().split("T")[0]===a).length,totalAssigned:t.length,pending:t.filter(e=>"pending"===e.status).length}),v(!1)});return()=>{r()}},[I]),(0,r.useEffect)(()=>{if(!I)return;if(u.isMockMode)return void O([]);let e=(0,p.query)((0,p.collection)(u.db,"notifications"),(0,p.where)("role","==","technician"),(0,p.where)("userId","==",I.uid||I.id),(0,p.orderBy)("createdAt","desc")),t=(0,p.onSnapshot)(e,e=>{O(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>{t()}},[I]),(0,t.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-white",children:e("Technician Dashboard")}),(0,t.jsxs)("p",{className:"text-white/60 mt-1",children:[e("Welcome back"),", ",I?.name||"Technician"]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(g.Button,{onClick:()=>b.push("/technician/orders"),variant:"outline",className:"border-cyan-500/50 text-cyan-500 hover:bg-cyan-500/10",children:e("View All Orders")})})]}),R&&(0,t.jsx)(j,{technicianId:R}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)(a.Card,{className:"relative overflow-hidden bg-gradient-to-br from-cyan-500/10 via-blue-500/10 to-purple-500/10 border-white/10 backdrop-blur-md ring-1 ring-white/10",children:[(0,t.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[(0,t.jsx)("div",{className:"absolute -inset-1 rounded-xl bg-[linear-gradient(to_right,#ffffff12_1px,transparent_1px),linear-gradient(to_bottom,#ffffff10_1px,transparent_1px)] bg-[size:22px_22px] opacity-15"}),(0,t.jsx)("div",{className:"absolute -top-20 -right-24 w-72 h-72 rounded-full bg-cyan-500/10 blur-2xl"}),(0,t.jsx)("div",{className:"absolute -bottom-28 -left-28 w-80 h-80 rounded-full bg-blue-500/10 blur-2xl"})]}),(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-white/80",children:e("Active Jobs")}),(0,t.jsx)(o.Activity,{className:"h-4 w-4 text-cyan-500"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:f?"...":M.activeJobs}),(0,t.jsx)("p",{className:"text-xs text-white/60",children:e("Orders in progress")})]})]}),(0,t.jsxs)(a.Card,{className:"bg-white/5 border-white/10 backdrop-blur-sm",children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-white/80",children:e("Pending")}),(0,t.jsx)(i.Clock,{className:"h-4 w-4 text-yellow-500"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:f?"...":M.pending}),(0,t.jsx)("p",{className:"text-xs text-white/60",children:e("Waiting for action")})]})]}),(0,t.jsxs)(a.Card,{className:"bg-white/5 border-white/10 backdrop-blur-sm",children:[(0,t.jsxs)(a.CardHeader,{className:"relative flex flex-row items-center justify-between space-y-0 px-6 py-3 rounded-xl bg-gradient-to-r from-emerald-500/15 via-cyan-500/10 to-cyan-500/20 border border-white/10 shadow-[0_8px_30px_-12px_rgba(6,182,212,0.35)]",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-semibold text-transparent bg-clip-text bg-gradient-to-r from-white via-white to-cyan-200",children:e("Completed Today")}),(0,t.jsxs)("div",{className:"relative flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/20 ring-2 ring-emerald-400/30 shadow-[0_0_20px_rgba(34,197,94,0.25)]",children:[(0,t.jsx)(n.default,{className:"h-4 w-4 text-emerald-400"}),(0,t.jsx)("span",{className:"absolute inset-0 rounded-full blur-[6px] bg-emerald-500/30 opacity-40"})]})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:f?"...":M.completedToday}),(0,t.jsx)("p",{className:"text-xs text-white/60",children:e("Successfully finished")})]})]}),(0,t.jsxs)(a.Card,{className:"bg-white/5 border-white/10 backdrop-blur-sm",children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-white/80",children:e("Total Assigned")}),(0,t.jsx)(s.ShoppingCart,{className:"h-4 w-4 text-purple-500"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:f?"...":M.totalAssigned}),(0,t.jsx)("p",{className:"text-xs text-white/60",children:e("Lifetime orders")})]})]})]}),(0,t.jsxs)(a.Card,{className:"bg-white/5 border-white/10 backdrop-blur-sm",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-white",children:e("Recent Assigned Orders")})}),(0,t.jsx)(a.CardContent,{children:f?(0,t.jsx)("div",{className:"text-center py-10 text-white/50",children:e("Loading orders...")}):0===D.length?(0,t.jsx)("div",{className:"text-center py-10 text-white/50",children:e("No orders assigned yet.")}):(0,t.jsx)("div",{className:"space-y-4",children:D.slice(0,5).map(r=>(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between p-4 rounded-lg bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer",onClick:()=>b.push(`/technician/order/${r.id}`),children:[(0,t.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,t.jsx)("div",{className:"h-12 w-12 rounded-full bg-cyan-500/20 flex items-center justify-center shrink-0",children:(0,t.jsx)(c.Smartphone,{className:"h-6 w-6 text-cyan-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold text-white",children:[r.device," ",(0,t.jsxs)("span",{className:"text-white/40 text-sm",children:["#",r.id]})]}),(0,t.jsx)("p",{className:"text-sm text-white/60",children:r.issue}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2 text-xs text-white/50",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(l.Calendar,{className:"w-3 h-3"})," ",new Date(r.date||r.createdAt).toLocaleDateString()]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(d.MapPin,{className:"w-3 h-3"})," ",r.location||"N/A"]})]})]})]}),(0,t.jsxs)("div",{className:"mt-4 md:mt-0 flex flex-col items-end gap-2 w-full md:w-auto",children:[(0,t.jsx)(m.Badge,{variant:"outline",className:(e=>{switch(e){case"pending":return"bg-yellow-500/20 text-yellow-500 border-yellow-500/50";case"in_progress":return"bg-blue-500/20 text-blue-500 border-blue-500/50";case"on_way":return"bg-purple-500/20 text-purple-500 border-purple-500/50";case"completed":return"bg-green-500/20 text-green-500 border-green-500/50";case"cancelled":return"bg-red-500/20 text-red-500 border-red-500/50";default:return"bg-gray-500/20 text-gray-500 border-gray-500/50"}})(r.status),children:r.status.replace("_"," ").toUpperCase()}),(0,t.jsxs)("span",{className:"text-cyan-400 font-mono font-medium",children:[r.price," AED"]}),"assigned"===r.status&&(0,t.jsx)(g.Button,{variant:"outline",className:"w-full bg-white/5 border-white/10 hover:bg-white/10 text-white",onClick:async e=>{if(e.stopPropagation(),u.isMockMode)B(e=>e.map(e=>e.id===r.id?{...e,status:"accepted"}:e));else if(I?.uid)try{await (0,S.acceptAssignedOrder)(r.id,I.uid)}catch(e){y.logger.error(e)}},children:e("Accept Order")}),"countered"===r.pricingStatus&&(0,t.jsx)(g.Button,{variant:"outline",className:"w-full bg-white/5 border-white/10 hover:bg-white/10 text-white",onClick:async e=>{if(e.stopPropagation(),u.isMockMode)B(e=>e.map(e=>e.id===r.id?{...e,pricingStatus:"re_accepted"}:e));else if(I?.uid)try{await (0,S.reAcceptCounterOffer)(r.id,I.uid)}catch(e){y.logger.error(e)}},children:e("Accept Counter-Offer")}),(0,t.jsx)("div",{className:"text-xs text-white/60",children:r.pricingStatus&&(0,t.jsxs)("span",{className:"px-2 py-1 rounded bg-white/10 border border-white/10",children:[e("Pricing"),": ",r.pricingStatus]})}),"approved"===r.pricingStatus&&"accepted"===r.status&&(0,t.jsx)(g.Button,{className:"w-full bg-green-600 hover:bg-green-700 text-white",onClick:async e=>{if(e.stopPropagation(),u.isMockMode)B(e=>e.map(e=>e.id===r.id?{...e,status:"in_progress"}:e));else if(I?.uid)try{await (0,S.startWork)(r.id,I.uid)}catch(e){y.logger.error(e)}},children:e("Start Work")}),("assigned"===r.status||"accepted"===r.status)&&((r.pricingStatus??"none")==="none"||"rejected"===r.pricingStatus||"countered"===r.pricingStatus)&&(0,t.jsx)("div",{className:"w-full md:w-auto mt-2 p-2 rounded border border-white/10 bg-white/5",onClick:e=>e.stopPropagation(),children:U!==r.id?(0,t.jsx)(g.Button,{variant:"outline",className:"w-full bg-white/5 border-white/10 hover:bg-white/10 text-white",onClick:()=>$(r.id),children:e("Propose Price & Time")}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(g.Button,{variant:"range"===K?"default":"outline",onClick:()=>G("range"),children:e("Range")}),(0,t.jsx)(g.Button,{variant:"breakdown"===K?"default":"outline",onClick:()=>G("breakdown"),children:e("Breakdown")})]}),"range"===K?(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsx)(C.Input,{type:"number",placeholder:e("Price Min (AED)"),value:Q,onChange:e=>X(e.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,t.jsx)(C.Input,{type:"number",placeholder:e("Price Max (AED)"),value:Y,onChange:e=>ee(e.target.value),className:"bg-white/5 border-white/10 text-white"})]}):(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,t.jsx)(C.Input,{type:"number",placeholder:e("Labor"),value:et,onChange:e=>er(e.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,t.jsx)(C.Input,{type:"number",placeholder:e("Parts"),value:ea,onChange:e=>es(e.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,t.jsx)(C.Input,{type:"number",placeholder:e("Inspection"),value:ei,onChange:e=>en(e.target.value),className:"bg-white/5 border-white/10 text-white"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(C.Input,{type:"number",placeholder:e("Estimated Time"),value:F,onChange:e=>H(e.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,t.jsxs)(A.Select,{value:q,onValueChange:e=>z(e),children:[(0,t.jsx)(A.SelectTrigger,{className:"bg-white/5 border-white/10 text-white",children:(0,t.jsx)(A.SelectValue,{placeholder:e("Unit")})}),(0,t.jsxs)(A.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsx)(A.SelectItem,{value:"minutes",children:e("Minutes")}),(0,t.jsx)(A.SelectItem,{value:"hours",children:e("Hours")})]})]})]}),(0,t.jsx)(C.Input,{type:"text",placeholder:e("Arrival ETA (e.g., 2025-01-01 14:00)"),value:V,onChange:e=>Z(e.target.value),className:"bg-white/5 border-white/10 text-white"})]}),(0,t.jsx)(k.Textarea,{placeholder:e("Note (optional)"),value:W,onChange:e=>J(e.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(C.Input,{type:"file",multiple:!0,accept:"image/*,video/*",onChange:async e=>{let t=Array.from(e.target.files||[]);if(!t.length)return;let a=[];for(let e of t)try{if(!u.storage||u.isMockMode)a.push(URL.createObjectURL(e));else{let t=(0,T.ref)(u.storage,`orders/${r.id}/proposal/${Date.now()}_${e.name}`);await (0,T.uploadBytes)(t,e);let s=await (0,T.getDownloadURL)(t);a.push(s)}}catch(e){y.logger.error(e)}el(a)},className:"bg-white/5 border-white/10 text-white"}),eo.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2 mt-2",children:eo.map((e,r)=>(0,t.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",className:"block aspect-square rounded border border-white/10 overflow-hidden",children:(0,t.jsx)("img",{src:e,alt:"media",className:"w-full h-full object-cover"})},r))})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(g.Button,{className:"bg-cyan-500 hover:bg-cyan-400 text-black",onClick:async()=>{let e,t,a,s=parseFloat(F);if(isNaN(s)||s<=0||!R)return;if("range"===K){let r=parseFloat(Q),a=parseFloat(Y);if(isNaN(r)||isNaN(a)||r<=0||a<=0)return;e=r,t=a}else{let e=parseFloat(et||"0"),t=parseFloat(ea||"0"),r=parseFloat(ei||"0");if(e<=0&&t<=0&&r<=0)return;a={labor:e||0,parts:t||0,inspection:r||0}}let i="hours"===q?Math.round(60*s):Math.round(s);u.isMockMode?B(s=>s.map(s=>s.id===r.id?{...s,proposedPrice:t??(a?(a.labor||0)+(a.parts||0)+(a.inspection||0):null),proposedPriceMin:e??null,proposedPriceMax:t??null,proposedBreakdown:a??null,proposedDurationMinutes:i,proposedArrivalETA:V||null,proposalNote:W||null,proposedByTechnicianId:I.uid,proposedAt:new Date().toISOString(),pricingStatus:"proposed",proposalMediaUrls:eo}:s)):await (0,S.proposeOrderPricing)(r.id,{proposedPriceMin:e??null,proposedPriceMax:t??null,proposedBreakdown:a??null,proposedDurationMinutes:i,proposedArrivalETA:V||null,proposalNote:W||void 0,proposalMediaUrls:eo,proposedByTechnicianId:I.uid}),$(null),X(""),ee(""),er(""),es(""),en(""),H(""),z("minutes"),J(""),Z(""),el([])},children:e("Submit Proposal")}),(0,t.jsx)(g.Button,{variant:"outline",className:"bg-white/5 border-white/10 text-white",onClick:()=>{$(null),X(""),ee(""),er(""),es(""),en(""),H(""),z("minutes"),J(""),Z(""),el([])},children:e("Cancel")})]})]})})]})]},r.id))})})]}),(0,t.jsxs)(a.Card,{className:"bg-white/5 border-white/10 backdrop-blur-sm",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{className:"text-white",children:e("Notifications")})}),(0,t.jsx)(a.CardContent,{children:0===_.length?(0,t.jsx)("div",{className:"text-white/50",children:e("No notifications")}):(0,t.jsx)("div",{className:"space-y-3",children:_.slice(0,6).map(e=>(0,t.jsxs)("div",{className:"p-2 rounded bg-white/5 border border-white/10 text-sm",children:[(0,t.jsx)("div",{className:"text-white",children:e.message}),(0,t.jsx)("div",{className:"text-white/40 text-[10px]",children:new Date(e.createdAt?.toDate?.()||e.createdAt).toLocaleString()})]},e.id))})})]})]})}e.s(["default",()=>M],26919)}]);