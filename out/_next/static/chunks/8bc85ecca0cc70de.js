(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let t=(0,e.i(75254).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>t],55436)},87486,e=>{"use strict";var t=e.i(43476),a=e.i(91918),s=e.i(25913),i=e.i(75157);let r=(0,s.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,asChild:l=!1,...n}){let c=l?a.Slot:"span";return(0,t.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(r({variant:s}),e),...n})}e.s(["Badge",()=>l])},15288,e=>{"use strict";var t=e.i(43476),a=e.i(75157);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function l({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>l,"CardHeader",()=>i,"CardTitle",()=>r])},18071,e=>{"use strict";var t=e.i(83814);function a(){let{lang:e,setLang:a}=(0,t.useLanguage)();return{language:e,setLanguage:a,t:(0,t.useT)()}}e.s(["useLanguage",()=>a])},27612,e=>{"use strict";let t=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],27612)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},76639,e=>{"use strict";var t=e.i(43476),a=e.i(26999),s=e.i(95926),i=e.i(75157);function r({...e}){return(0,t.jsx)(a.Root,{"data-slot":"dialog",...e})}function l({...e}){return(0,t.jsx)(a.Trigger,{"data-slot":"dialog-trigger",...e})}function n({...e}){return(0,t.jsx)(a.Portal,{"data-slot":"dialog-portal",...e})}function c({className:e,...s}){return(0,t.jsx)(a.Overlay,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...s})}function d({className:e,children:r,showCloseButton:l=!0,...d}){return(0,t.jsxs)(n,{"data-slot":"dialog-portal",children:[(0,t.jsx)(c,{}),(0,t.jsxs)(a.Content,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...d,children:[r,l&&(0,t.jsxs)(a.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(s.XIcon,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function o({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",e),...a})}function h({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...a})}function u({className:e,...s}){return(0,t.jsx)(a.Title,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",e),...s})}function x({className:e,...s}){return(0,t.jsx)(a.Description,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",e),...s})}e.s(["Dialog",()=>r,"DialogContent",()=>d,"DialogDescription",()=>x,"DialogFooter",()=>h,"DialogHeader",()=>o,"DialogTitle",()=>u,"DialogTrigger",()=>l])},69638,6321,e=>{"use strict";let t=(0,e.i(75254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>t],6321),e.s(["CheckCircle",()=>t],69638)},78894,e=>{"use strict";let t=(0,e.i(75254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},13942,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(15288),i=e.i(19455),r=e.i(93479),l=e.i(87486),n=e.i(67489),c=e.i(76639),d=e.i(55436),o=e.i(7233),h=e.i(88844),u=e.i(78894),x=e.i(75254);let m=(0,x.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var g=e.i(27612);let p=(0,x.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var v=e.i(69638);let b=(0,x.default)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);e.i(36180);var j=e.i(98925),w=e.i(11605),y=e.i(75157);let f=["Screens","Batteries","Charging Ports","Speakers","Cameras","Motherboards","Flex Cables","Buttons","Housings","Tools","Adhesives","Other"],N=["Apple","Samsung","Huawei","Xiaomi","OnePlus","Google","Sony","LG","Universal","Other"];function S({isAdmin:e=!0,onStatsUpdate:x}){let S,[k,C]=(0,a.useState)([]),[D,I]=(0,a.useState)([]),[M,q]=(0,a.useState)(!0),[A,T]=(0,a.useState)(""),[P,B]=(0,a.useState)("all"),[L,U]=(0,a.useState)("all"),[z,V]=(0,a.useState)("all"),[O,$]=(0,a.useState)("name"),[E,F]=(0,a.useState)(!1),[H,R]=(0,a.useState)(null),[_,K]=(0,a.useState)("details"),[Q,G]=(0,a.useState)([]),[X,Y]=(0,a.useState)([]),[J,W]=(0,a.useState)(null),[Z,ee]=(0,a.useState)(!1),[et,ea]=(0,a.useState)({name:"",sku:"",category:"Screens",brand:"Apple",compatibleDevices:"",quantity:0,minStock:5,price:0,cost:0,location:"",supplier:"",description:""});(0,a.useEffect)(()=>{if(w.isMockMode){C([]),q(!1),x?.({totalParts:0,totalValue:0,lowStockCount:0,outOfStockCount:0});return}let e=(0,j.query)((0,j.collection)(w.db,"parts"),(0,j.orderBy)("name","asc")),t=(0,j.onSnapshot)(e,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));C(t),q(!1);let a=t.length,s=t.reduce((e,t)=>e+t.quantity*t.cost,0),i=t.filter(e=>e.quantity<=e.minStock&&e.quantity>0).length,r=t.filter(e=>0===e.quantity).length;x?.({totalParts:a,totalValue:s,lowStockCount:i,outOfStockCount:r})});return()=>t()},[]),(0,a.useEffect)(()=>{if(w.isMockMode)return void I(e=>e.length?e:[{id:"mock-s1",name:"Default Supplier",phone:"971500000000",email:"supplier@example.com",partsIds:[]}]);let e=(0,j.onSnapshot)((0,j.collection)(w.db,"suppliers"),e=>{I(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>e()},[]),(0,a.useEffect)(()=>{let e;if(E&&H)if(w.isMockMode)Y(Q.filter(e=>e.partId===H.id).sort((e,t)=>{let a=e.createdAt?.seconds??0;return(t.createdAt?.seconds??0)-a}));else{let t=(0,j.query)((0,j.collection)(w.db,"stock_movements"),(0,j.where)("partId","==",H.id),(0,j.orderBy)("createdAt","desc"));e=(0,j.onSnapshot)(t,e=>{Y(e.docs.map(e=>({id:e.id,...e.data()})))})}else Y([]);return()=>{"function"==typeof e&&e()}},[E,H,w.isMockMode,Q]);let es=k.filter(e=>{let t=""===A||e.name.toLowerCase().includes(A.toLowerCase())||e.sku.toLowerCase().includes(A.toLowerCase())||e.brand.toLowerCase().includes(A.toLowerCase()),a="all"===P||e.category===P,s="all"===L||e.brand===L,i="all"===z||("low"===z?e.quantity<=e.minStock&&e.quantity>0:"out"!==z||0===e.quantity);return t&&a&&s&&i}).sort((e,t)=>"name"===O?e.name.localeCompare(t.name):"quantity"===O?e.quantity-t.quantity:"category"===O?e.category.localeCompare(t.category):0),ei=async()=>{if(!et.name.trim())return;let e={...et,compatibleDevices:et.compatibleDevices.split(",").map(e=>e.trim()).filter(Boolean),createdAt:j.Timestamp.now(),updatedAt:j.Timestamp.now()};if(H){await (0,j.updateDoc)((0,j.doc)(w.db,"parts",H.id),{...e,updatedAt:j.Timestamp.now()});let t=e.quantity-H.quantity;if(0!==t){let e={partId:H.id,type:t>0?"IN":"OUT",quantity:Math.abs(t),reason:"adjustment",orderId:null,userId:w.auth.currentUser?.uid||"system",createdAt:j.Timestamp.now()};w.isMockMode?G(t=>[e,...t]):await (0,j.addDoc)((0,j.collection)(w.db,"stock_movements"),e)}if(e.supplier){let t=e.supplier;try{w.isMockMode?I(e=>e.map(e=>e.id===t?{...e,partsIds:Array.from(new Set([...e.partsIds||[],H.id]))}:e)):await (0,j.updateDoc)((0,j.doc)(w.db,"suppliers",t),{partsIds:(0,j.arrayUnion)(H.id)})}catch{}}}else{let t=await (0,j.addDoc)((0,j.collection)(w.db,"parts"),e);if(e.quantity>0){let a={partId:t.id,type:"IN",quantity:e.quantity,reason:"purchase",orderId:null,userId:w.auth.currentUser?.uid||"system",createdAt:j.Timestamp.now()};w.isMockMode?G(e=>[a,...e]):await (0,j.addDoc)((0,j.collection)(w.db,"stock_movements"),a)}if(e.supplier){let a=e.supplier;try{w.isMockMode?I(e=>e.map(e=>e.id===a?{...e,partsIds:Array.from(new Set([...e.partsIds||[],t.id]))}:e)):await (0,j.updateDoc)((0,j.doc)(w.db,"suppliers",a),{partsIds:(0,j.arrayUnion)(t.id)})}catch{}}}en(),F(!1),R(null)},er=async e=>{confirm("Delete this part?")&&await (0,j.deleteDoc)((0,j.doc)(w.db,"parts",e))},el=async(e,t)=>{let a=k.find(t=>t.id===e);if(!a)return;let s=Math.max(0,a.quantity+t);if(await (0,j.updateDoc)((0,j.doc)(w.db,"parts",e),{quantity:s,updatedAt:j.Timestamp.now()}),0!==t){let a={partId:e,type:t>0?"IN":"OUT",quantity:Math.abs(t),reason:t>0?"purchase":"repair",orderId:null,userId:w.auth.currentUser?.uid||"system",createdAt:j.Timestamp.now()};w.isMockMode?G(e=>[a,...e]):await (0,j.addDoc)((0,j.collection)(w.db,"stock_movements"),a)}},en=()=>{ea({name:"",sku:"",category:"Screens",brand:"Apple",compatibleDevices:"",quantity:0,minStock:5,price:0,cost:0,location:"",supplier:"",description:""})},ec=(0,a.useMemo)(()=>{if("super"===window.localStorage.getItem("mock_admin_role"))return!0;let e=w.auth.currentUser?.email?.toLowerCase()||"";return e.includes("super")||e.includes("founder")},[]),ed=e=>{let t=(e.price||0)-(e.cost||0),a=e.cost>0?t/e.cost*100:0,s="bg-green-500/20 text-green-400";return a<15?s="bg-red-500/20 text-red-400":a>=15&&a<=30&&(s="bg-yellow-500/20 text-yellow-400"),{profit:t,margin:a,color:s}},eo=k.length,eh=k.reduce((e,t)=>e+t.quantity*t.cost,0),eu=k.filter(e=>e.quantity<=e.minStock&&e.quantity>0).length,ex=k.filter(e=>0===e.quantity).length;return M?(0,t.jsx)(s.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(s.CardContent,{className:"p-8 text-center text-white/50",children:"Loading inventory..."})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsx)(s.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:(0,t.jsx)(h.Package,{className:"w-5 h-5 text-cyan-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-white/60",children:"Total Parts"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-white",children:eo})]})]})})}),(0,t.jsx)(s.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-green-500/20 rounded-lg",children:(0,t.jsx)(v.CheckCircle,{className:"w-5 h-5 text-green-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-white/60",children:"Inventory Value"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-white",children:[eh.toLocaleString()," AED"]})]})]})})}),(0,t.jsx)(s.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:(0,t.jsx)(u.AlertTriangle,{className:"w-5 h-5 text-yellow-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-white/60",children:"Low Stock"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-white",children:eu})]})]})})}),(0,t.jsx)(s.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-red-500/20 rounded-lg",children:(0,t.jsx)(u.AlertTriangle,{className:"w-5 h-5 text-red-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-white/60",children:"Out of Stock"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-white",children:ex})]})]})})})]}),(0,t.jsx)(s.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(s.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,t.jsx)(d.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/40"}),(0,t.jsx)(r.Input,{placeholder:"Search parts by name, SKU, or brand...",value:A,onChange:e=>T(e.target.value),className:"pl-9 bg-white/5 border-white/10 text-white"})]}),(0,t.jsxs)(n.Select,{value:P,onValueChange:B,children:[(0,t.jsx)(n.SelectTrigger,{className:"w-[150px] bg-white/5 border-white/10 text-white hover:bg-white/10 focus-visible:border-cyan-500 focus-visible:ring-cyan-500/30 outline-none rounded-lg",children:(0,t.jsx)(n.SelectValue,{placeholder:"Category"})}),(0,t.jsxs)(n.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All Categories"}),f.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]}),(0,t.jsxs)(n.Select,{value:L,onValueChange:U,children:[(0,t.jsx)(n.SelectTrigger,{className:"w-[130px] bg-white/5 border-white/10 text-white hover:bg-white/10 focus-visible:border-cyan-500 focus-visible:ring-cyan-500/30 outline-none rounded-lg",children:(0,t.jsx)(n.SelectValue,{placeholder:"Brand"})}),(0,t.jsxs)(n.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All Brands"}),N.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))]})]}),(0,t.jsxs)(n.Select,{value:z,onValueChange:e=>V(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-[130px] bg-white/5 border-white/10 text-white hover:bg-white/10 focus-visible:border-cyan-500 focus-visible:ring-cyan-500/30 outline-none rounded-lg",children:(0,t.jsx)(n.SelectValue,{placeholder:"Stock"})}),(0,t.jsxs)(n.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All Stock"}),(0,t.jsx)(n.SelectItem,{value:"low",children:"Low Stock"}),(0,t.jsx)(n.SelectItem,{value:"out",children:"Out of Stock"})]})]}),(0,t.jsxs)(i.Button,{onClick:()=>{var e,t;let a,s,i,r,l,n,c,d,o;return a=e=>e.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.slice(1)),s=e=>Number(e||0).toFixed(2),i=e=>{let t;return t=null==e||""===e?"â€”":String(e),`"${t.replace(/"/g,'""')}"`},r="\uFEFF"+["SKU,Part Name,Category,Brand,Compatible Devices,Supplier,Location,Quantity,Min Stock,Stock Status,Cost (AED),Price (AED),Profit (AED),Margin (%),Last Updated",...es.map(e=>{var t,r,l,n;let c,d,o,h,u=e.sku||"â€”",x=e.name||"â€”",m=e.category?a(String(e.category)):"â€”",g=e.brand?a(String(e.brand)):"â€”",p=(e=>{if(!Array.isArray(e)||0===e.length)return"â€”";let t=e.map(e=>String(e).trim()).filter(Boolean);return t.length?t.join(" | "):"â€”"})(e.compatibleDevices),v=e.supplier||"â€”",b=e.location||"â€”",j=Number(e.quantity||0),w=Number(e.minStock||e.minQuantity||0),y=(c=Number(j||0),d=Number(w||0),0===c?"Out Of Stock":c>d?"In Stock":"Low Stock"),f=s(e.cost??e.costPrice),N=s(e.price),S=(t=e.price,r=e.cost??e.costPrice,(Number(t||0)-Number(r||0)).toFixed(2)),k=(l=e.price,n=e.cost??e.costPrice,o=Number(l||0),(h=Number(n||0))<=0?"0":String(Math.round((o-h)/h*100))),C=(e=>{if(!e)return"â€”";let t=null;if("function"==typeof e?.toDate?t=e.toDate():"number"==typeof e||"string"==typeof e?t=new Date(e):e?.seconds&&(t=new Date(1e3*e.seconds)),!t||isNaN(t.getTime()))return"â€”";let a=e=>e<10?`0${e}`:String(e),s=t.getFullYear(),i=a(t.getMonth()+1),r=a(t.getDate()),l=a(t.getHours()),n=a(t.getMinutes());return`${s}-${i}-${r} ${l}:${n}`})(e.updatedAt);return[i(u),i(x),i(m),i(g),i(p),i(v),i(b),String(j),String(w),i(y),String(f),String(N),String(S),String(k),i(C)].join(",")})].join("\r\n"),l=e=>e<10?`0${e}`:String(e),n=new Date,void(e=r,t=`inventory_export_${n.getFullYear()}-${l(n.getMonth()+1)}-${l(n.getDate())}.csv`,c=new Blob([e],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(c),(o=document.createElement("a")).href=d,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(d))},className:"bg-white/10 hover:bg-white/20 border border-white/20 text-white",children:[(0,t.jsx)(p,{className:"w-4 h-4 mr-2"})," Export CSV"]}),e&&(0,t.jsxs)(c.Dialog,{open:E,onOpenChange:F,children:[(0,t.jsx)(c.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(i.Button,{onClick:()=>{en(),R(null)},className:"bg-cyan-500 hover:bg-cyan-400",children:[(0,t.jsx)(o.Plus,{className:"w-4 h-4 mr-2"})," Add Part"]})}),(0,t.jsxs)(c.DialogContent,{className:"bg-zinc-900 border-white/10 text-white max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(c.DialogHeader,{children:(0,t.jsx)(c.DialogTitle,{children:H?"Edit Part":"Add New Part"})}),H&&(0,t.jsx)("div",{className:"space-y-2 px-1",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.Button,{variant:"details"===_?"default":"outline",onClick:()=>K("details"),className:"details"===_?"bg-cyan-500 text-black hover:bg-cyan-400":"",children:"Details"}),(0,t.jsx)(i.Button,{variant:"history"===_?"default":"outline",onClick:()=>K("history"),className:"history"===_?"bg-cyan-500 text-black hover:bg-cyan-400":"",children:"Stock History"})]})}),"history"===_&&H?(0,t.jsx)("div",{className:"space-y-3",children:0===X.length?(0,t.jsx)("div",{className:"text-white/50",children:"No stock movements for this part yet"}):X.map(e=>{let a=e.createdAt?.toDate?e.createdAt.toDate().toLocaleString():new Date().toLocaleString();return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 border border-white/10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(l.Badge,{variant:"outline",className:"IN"===e.type?"text-xs bg-green-500/20 text-green-400 border-white/10":"text-xs bg-red-500/20 text-red-400 border-white/10",children:e.type}),(0,t.jsx)("div",{className:"text-white",children:e.quantity}),(0,t.jsx)("div",{className:"text-white/70",children:e.reason}),e.orderId?(0,t.jsxs)(l.Badge,{variant:"outline",className:"text-xs bg-white/5 border-white/10 text-white/70",children:["Order ",e.orderId]}):null]}),(0,t.jsxs)("div",{className:"text-right text-xs text-white/60",children:[(0,t.jsx)("div",{children:a}),(0,t.jsx)("div",{children:e.userId})]})]},(e.id??"")+a)})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Part Name *"}),(0,t.jsx)(r.Input,{value:et.name,onChange:e=>ea({...et,name:e.target.value}),className:"bg-white/5 border-white/10"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"SKU"}),(0,t.jsx)(r.Input,{value:et.sku,onChange:e=>ea({...et,sku:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. IP13-SCR-001"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Category"}),(0,t.jsxs)(n.Select,{value:et.category,onValueChange:e=>ea({...et,category:e}),children:[(0,t.jsx)(n.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsx)(n.SelectContent,{children:f.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Brand"}),(0,t.jsxs)(n.Select,{value:et.brand,onValueChange:e=>ea({...et,brand:e}),children:[(0,t.jsx)(n.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsx)(n.SelectContent,{children:N.map(e=>(0,t.jsx)(n.SelectItem,{value:e,children:e},e))})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Compatible Devices (comma separated)"}),(0,t.jsx)(r.Input,{value:et.compatibleDevices,onChange:e=>ea({...et,compatibleDevices:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. iPhone 13, iPhone 13 Pro"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Quantity"}),(0,t.jsx)(r.Input,{type:"number",value:et.quantity,onChange:e=>ea({...et,quantity:Number(e.target.value)}),className:"bg-white/5 border-white/10"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Min Stock Alert"}),(0,t.jsx)(r.Input,{type:"number",value:et.minStock,onChange:e=>ea({...et,minStock:Number(e.target.value)}),className:"bg-white/5 border-white/10"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[ec&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Cost (AED)"}),(0,t.jsx)(r.Input,{type:"number",value:et.cost,onChange:e=>ea({...et,cost:Number(e.target.value)}),className:"bg-white/5 border-white/10"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Sell Price (AED)"}),(0,t.jsx)(r.Input,{type:"number",value:et.price,onChange:e=>ea({...et,price:Number(e.target.value)}),className:"bg-white/5 border-white/10"}),(0,t.jsx)("div",{className:"mt-1 text-xs text-white/50",children:(S=ed({cost:et.cost,price:et.price}),`Margin: ${Number.isFinite(S.margin)?Math.round(S.margin):0}%`)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Storage Location"}),(0,t.jsx)(r.Input,{value:et.location,onChange:e=>ea({...et,location:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. Shelf A-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Supplier"}),(0,t.jsxs)(n.Select,{value:et.supplier,onValueChange:e=>ea({...et,supplier:e}),children:[(0,t.jsx)(n.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select supplier"})}),(0,t.jsx)(n.SelectContent,{children:D.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))})]}),et.supplier&&D.find(e=>e.id===et.supplier)&&(0,t.jsxs)("div",{className:"mt-2 p-2 rounded bg-white/5 border border-white/10 text-xs text-white/70",children:[(0,t.jsx)("div",{children:D.find(e=>e.id===et.supplier)?.name}),(0,t.jsx)("div",{children:D.find(e=>e.id===et.supplier)?.phone}),D.find(e=>e.id===et.supplier)?.email&&(0,t.jsx)("div",{children:D.find(e=>e.id===et.supplier)?.email})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-white/60",children:"Description"}),(0,t.jsx)(r.Input,{value:et.description,onChange:e=>ea({...et,description:e.target.value}),className:"bg-white/5 border-white/10"})]})]}),(0,t.jsxs)(c.DialogFooter,{children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>F(!1),children:"Cancel"}),(0,t.jsxs)(i.Button,{className:"bg-cyan-500 hover:bg-cyan-400",onClick:ei,children:[H?"Update":"Add"," Part"]})]})]})]})]})})}),(0,t.jsxs)(s.Card,{className:"bg-white/5 border-white/10",children:[(0,t.jsx)(s.CardHeader,{children:(0,t.jsx)(s.CardTitle,{className:"text-white flex items-center justify-between",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Package,{className:"w-5 h-5 text-cyan-400"}),"Parts Inventory (",es.length,")",eu>0&&(0,t.jsxs)(l.Badge,{variant:"outline",className:"text-xs bg-yellow-500/20 text-yellow-400 border-yellow-500/40",children:["Low: ",eu]})]})})}),(0,t.jsx)(s.CardContent,{children:0===es.length?(0,t.jsx)("div",{className:"text-center py-8 text-white/40",children:0===k.length?"No parts in inventory yet":"No parts match your filters"}):(0,t.jsx)("div",{className:"space-y-3",children:es.map(a=>{let s=0===a.quantity?{color:"bg-red-500/20 text-red-400",label:"Out of Stock"}:a.quantity<=a.minStock?{color:"bg-yellow-500/20 text-yellow-400",label:"Low Stock"}:{color:"bg-green-500/20 text-green-400",label:"In Stock"},r=ed(a),n=0===a.quantity||a.quantity<=a.minStock;return(0,t.jsxs)("div",{className:(0,y.cn)("flex items-center gap-4 p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-colors border border-white/10",n&&(0===a.quantity?"ring-2 ring-red-500/40 border-red-500/30":"ring-2 ring-yellow-500/40 border-yellow-500/30")),children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg bg-cyan-500/10 flex items-center justify-center shrink-0",children:(0,t.jsx)(h.Package,{className:"w-6 h-6 text-cyan-400"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h4",{className:"font-medium text-white truncate",children:a.name}),(0,t.jsx)(l.Badge,{variant:"outline",className:"text-xs bg-white/5 border-white/10",children:a.sku||"No SKU"}),(0,t.jsx)(l.Badge,{variant:"outline",className:(0,y.cn)("text-xs",r.color),children:Number.isFinite(r.margin)?`${Math.round(r.margin)}%`:"â€”"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-white/50",children:[(0,t.jsx)("span",{children:a.category}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsx)("span",{children:a.brand}),a.location&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:["ðŸ“ ",a.location]})]}),a.supplier&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:["Supplier: ",D.find(e=>e.id===a.supplier)?.name||a.supplier]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-lg font-bold text-white",children:a.quantity}),(0,t.jsx)(l.Badge,{className:(0,y.cn)("text-xs",s.color),children:s.label})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>el(a.id,-1),className:"h-8 w-8 text-white/60 hover:text-white",children:"-"}),(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>el(a.id,1),className:"h-8 w-8 text-white/60 hover:text-white",children:"+"})]}),e&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>{W(a),ee(!0)},className:"h-8 w-8 text-white/60 hover:text-cyan-400",title:"View QR",children:(0,t.jsx)(b,{className:"w-4 h-4"})}),(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>{ea({name:a.name,sku:a.sku,category:a.category,brand:a.brand,compatibleDevices:a.compatibleDevices.join(", "),quantity:a.quantity,minStock:a.minStock,price:a.price,cost:a.cost,location:a.location,supplier:a.supplier,description:a.description}),R(a),K("details"),F(!0)},className:"h-8 w-8 text-white/60 hover:text-cyan-400",children:(0,t.jsx)(m,{className:"w-4 h-4"})}),(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>er(a.id),className:"h-8 w-8 text-white/60 hover:text-red-400",children:(0,t.jsx)(g.Trash2,{className:"w-4 h-4"})})]})]})]},a.id)})})})]}),(0,t.jsx)(c.Dialog,{open:Z,onOpenChange:ee,children:(0,t.jsxs)(c.DialogContent,{className:"bg-zinc-900 border-white/10 text-white max-w-sm",children:[(0,t.jsx)(c.DialogHeader,{children:(0,t.jsx)(c.DialogTitle,{children:"Part QR Code"})}),J&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"text-sm text-white/60",children:[J.name," â€¢ ",J.sku||"No SKU"]}),(0,t.jsx)("div",{className:"flex items-center justify-center p-3 bg-white/5 rounded-lg border border-white/10",children:(0,t.jsx)("img",{alt:"QR Code",src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(`${J.id}|${J.sku||""}`)}`,className:"rounded"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>window.print(),children:"Print"}),(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>el(J.id,1),children:"Scan (Add 1)"})]})]})]})})]})}e.s(["PartsInventory",()=>S],13942)},91860,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566);e.i(51718);var i=e.i(18357),r=e.i(11605),l=e.i(13942),n=e.i(18071),c=e.i(88844);function d(){let e=(0,s.useRouter)(),{t:d}=(0,n.useLanguage)(),[o,h]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{let t=(0,i.onAuthStateChanged)(r.auth,t=>{t?h(!0):e.replace("/technician/login")});return()=>t()},[e]),o)?(0,t.jsxs)("div",{className:"space-y-6 pb-20",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:(0,t.jsx)(c.Package,{className:"w-6 h-6 text-cyan-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white",children:d("Parts Inventory")}),(0,t.jsx)("p",{className:"text-white/60 text-sm",children:d("View and track spare parts")})]})]}),(0,t.jsx)(l.PartsInventory,{isAdmin:!1})]}):null}e.s(["default",()=>d])}]);