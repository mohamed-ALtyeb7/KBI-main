module.exports=[59383,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(42021),e=a.i(1312),f=a.i(14574);let g=(0,a.i(70106).default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var h=a.i(14548),i=a.i(81560),j=a.i(15618),k=a.i(3314),l=a.i(38632),m=a.i(63519),n=a.i(66718),o=a.i(70430),p=a.i(99570),q=a.i(80701),r=a.i(15055);a.i(69387);var s=a.i(60574),t=a.i(58712);a.i(30485);var u=a.i(31052),v=a.i(68114),w=a.i(42381);let x={viewOrders:!0,editOrders:!0,updateStatus:!0,uploadAttachments:!0,chat:!0,viewCorporateRequests:!1},y=["Smartphone","Laptop","PC / Desktop","Printer","Monitor","TV","Apple Watch","CCTV","TV Installation","Gaming Console"];function z(){let a=(0,e.useT)(),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)("Active"),[Z,$]=(0,c.useState)(x);(0,c.useEffect)(()=>{let a=(0,u.onAuthStateChanged)(t.auth,a=>{a&&A(!0)});return()=>a()},[]),(0,c.useEffect)(()=>{let a=(0,s.onSnapshot)((0,s.collection)(t.db,"technicians"),a=>{C(a.docs.map(a=>({id:a.id,...a.data()})))},a=>{v.logger.error("technicians subscription failed",a)});return()=>a()},[]),(0,c.useEffect)(()=>{let a=(0,s.onSnapshot)((0,s.collection)(t.db,"orders"),a=>{E(a.docs.map(a=>({id:a.id,...a.data()})))},a=>{v.logger.error("orders subscription failed",a)});return()=>a()},[]);let _=(0,c.useMemo)(()=>{let a={};for(let b of D)b.technician&&"Completed"!==b.status&&"Delivered"!==b.status&&"Cancelled"!==b.status&&(a[b.technician]=(a[b.technician]||0)+1);return a},[D]),aa=async()=>{if(!J.trim()||!L.trim()||!N.trim())return void alert("Name, Email and Password are required");try{let a={name:J,email:L,phone:P,phone2:R,role:"technician",specialization:V,status:X,permissions:Z,avatar:T,createdAt:new Date},b=await fetch("https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDJlbOtaBWZcKuzi-gOvqFYemcC__jaK1A",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:L,password:N,returnSecureToken:!1})}),c=await b.json();if(!b.ok){let a=c?.error?.message==="EMAIL_EXISTS"?"Email is already registered":c?.error?.message==="WEAK_PASSWORD : Password should be at least 6 characters"?"Password should be at least 6 characters":c?.error?.message||"Failed to create account";alert(a);return}let d=String(c.localId||"");if(!d)return void alert("Failed to create account");let e=await (0,s.addDoc)((0,s.collection)(t.db,"technicians"),{...a,uid:d});await (0,s.setDoc)((0,s.doc)(t.db,"users",d),{email:L,role:"technician",technicianId:e.id,createdAt:new Date}),ab()}catch(a){alert("Failed to add technician")}},ab=()=>{K(""),M(""),O(""),Q(""),S(""),U(""),W([]),Y("Active"),$(x),I(!1)},ac=async()=>{if(F)try{let a=(0,s.doc)(t.db,"technicians",F.id),{id:b,...c}=F;await (0,s.updateDoc)(a,c),G(null)}catch(a){alert("Failed to update technician")}},ad=async b=>{if(confirm(a("Are you sure you want to delete this technician?")))try{await (0,s.deleteDoc)((0,s.doc)(t.db,"technicians",b))}catch(a){alert("Failed to delete technician")}};return z?(0,b.jsxs)("section",{className:"pt-2 pb-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 mb-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:a("Technicians")}),(0,b.jsxs)(p.Button,{onClick:()=>I(!0),className:"bg-cyan-500 hover:bg-cyan-400 text-black",children:[(0,b.jsx)(j.Plus,{className:"w-4 h-4 mr-2"}),a("Add Technician")]})]}),(0,b.jsxs)("div",{className:"grid gap-6",children:[(0,b.jsx)(f.Dialog,{open:H,onOpenChange:a=>!a&&ab(),children:(0,b.jsxs)(f.DialogContent,{className:"bg-zinc-950 border-white/10 text-white max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:a("Add New Technician")}),(0,b.jsx)(f.DialogDescription,{children:a("Enter technician details and permissions")})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Name")}),(0,b.jsx)(n.Input,{value:J,onChange:a=>K(a.target.value),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Phone")}),(0,b.jsx)(n.Input,{value:P,onChange:a=>Q(a.target.value),className:"bg-white/5 border-white/10"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Secondary Phone")}),(0,b.jsx)(n.Input,{value:R,onChange:a=>S(a.target.value),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Photo")}),(0,b.jsx)(w.ImageUpload,{value:T,onChange:U,path:"technicians"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Email")}),(0,b.jsx)(n.Input,{type:"email",value:L,onChange:a=>M(a.target.value),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Password")}),(0,b.jsx)(n.Input,{type:"password",value:N,onChange:a=>O(a.target.value),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Specialization")}),(0,b.jsx)("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-2",children:y.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/5 border border-white/10",children:[(0,b.jsx)(r.Checkbox,{id:`new-spec-${a}`,checked:V.includes(a),onCheckedChange:()=>{W(b=>b.includes(a)?b.filter(b=>b!==a):[...b,a])},className:"border-white/20 data-[state=checked]:bg-cyan-500 data-[state=checked]:text-black"}),(0,b.jsx)("label",{htmlFor:`new-spec-${a}`,className:"text-xs text-white/80",children:a})]},a))}),V.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 pt-1",children:V.map((a,c)=>(0,b.jsx)("span",{className:"px-2 py-0.5 bg-cyan-500/10 text-cyan-400 rounded-full text-xs",children:a},`${a}-${c}`))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Status")}),(0,b.jsxs)(q.Select,{value:X,onValueChange:a=>Y(a),children:[(0,b.jsx)(q.SelectTrigger,{className:"bg-white/5 border-white/10 text-white hover:bg-white/10 focus-visible:border-cyan-500 focus-visible:ring-cyan-500/30 outline-none rounded-lg",children:(0,b.jsx)(q.SelectValue,{})}),(0,b.jsxs)(q.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,b.jsx)(q.SelectItem,{value:"Active",children:a("Active")}),(0,b.jsx)(q.SelectItem,{value:"Inactive",children:a("Inactive")})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-4 border-t border-white/10",children:[(0,b.jsxs)(o.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Shield,{className:"w-4 h-4 text-cyan-500"})," ",a("Permissions")]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.keys(x).map(c=>(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/5 border border-white/10",children:[(0,b.jsx)(r.Checkbox,{id:`new-perm-${c}`,checked:Z[c],onCheckedChange:()=>{$(a=>({...a,[c]:!a[c]}))},className:"border-white/20 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500 data-[state=checked]:text-black"}),(0,b.jsx)("label",{htmlFor:`new-perm-${c}`,className:"text-sm text-white/80",children:a(c.replace(/([A-Z])/g," $1").trim())})]},c))})]})]}),(0,b.jsxs)(f.DialogFooter,{children:[(0,b.jsx)(p.Button,{variant:"outline",onClick:ab,className:"border-white/10 text-white hover:bg-white/10",children:a("Cancel")}),(0,b.jsx)(p.Button,{onClick:aa,className:"bg-cyan-500 hover:bg-cyan-400 text-black",children:a("Add")})]})]})}),(0,b.jsx)(d.GlassCard,{className:"p-0 overflow-hidden",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-left text-sm text-white/80",children:[(0,b.jsx)("thead",{className:"bg-white/5 text-white border-b border-white/10",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-4 font-medium",children:a("Name")}),(0,b.jsx)("th",{className:"p-4 font-medium",children:a("Phone")}),(0,b.jsx)("th",{className:"p-4 font-medium",children:a("Specialization")}),(0,b.jsx)("th",{className:"p-4 font-medium",children:a("Status")}),(0,b.jsx)("th",{className:"p-4 font-medium",children:a("Active Jobs")}),(0,b.jsx)("th",{className:"p-4 font-medium text-right",children:a("Actions")})]})}),(0,b.jsxs)("tbody",{className:"divide-y divide-white/5",children:[B.map(c=>(0,b.jsxs)("tr",{className:"hover:bg-white/5 transition-colors",children:[(0,b.jsx)("td",{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[c.avatar?(0,b.jsx)("img",{src:c.avatar,alt:c.name,className:"w-8 h-8 rounded-full object-cover border border-white/10"}):(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-white/5 border border-white/10 flex items-center justify-center",children:(0,b.jsx)(l.Image,{className:"w-4 h-4 text-white/40"})}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-white",children:c.name}),(0,b.jsx)("span",{className:"text-xs text-white/50",children:c.email})]})]})}),(0,b.jsx)("td",{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1 text-white/80",children:[(0,b.jsx)(m.Phone,{className:"w-3 h-3 text-cyan-400"})," ",c.phone]}),c.phone2&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-white/60",children:[(0,b.jsx)(m.Phone,{className:"w-3 h-3 text-cyan-400"})," ",c.phone2]})]})}),(0,b.jsx)("td",{className:"p-4",children:(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:c.specialization?.map((a,c)=>(0,b.jsx)("span",{className:"px-2 py-0.5 bg-white/10 rounded-full text-xs",children:a},c))})}),(0,b.jsx)("td",{className:"p-4",children:(0,b.jsx)("span",{className:"Active"===c.status?"text-green-400":"text-red-400",children:a(c.status)})}),(0,b.jsx)("td",{className:"p-4",children:(0,b.jsx)("span",{className:"font-mono bg-cyan-500/10 text-cyan-400 px-2 py-1 rounded",children:_[c.id]||0})}),(0,b.jsx)("td",{className:"p-4 text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(p.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 hover:bg-white/10",onClick:()=>G(c),children:(0,b.jsx)(g,{className:"w-4 h-4 text-cyan-400"})}),(0,b.jsx)(p.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 hover:bg-red-500/20",onClick:()=>ad(c.id),children:(0,b.jsx)(i.Trash2,{className:"w-4 h-4 text-red-400"})})]})})]},c.id)),0===B.length&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:6,className:"p-8 text-center text-white/40",children:a("No technicians found")})})]})]})})}),(0,b.jsx)(f.Dialog,{open:!!F,onOpenChange:a=>!a&&G(null),children:(0,b.jsxs)(f.DialogContent,{className:"bg-zinc-950 border-white/10 text-white max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:a("Edit Technician")}),(0,b.jsx)(f.DialogDescription,{children:a("Update technician details and permissions")})]}),F&&(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Name")}),(0,b.jsx)(n.Input,{value:F.name,onChange:a=>G({...F,name:a.target.value}),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Phone")}),(0,b.jsx)(n.Input,{value:F.phone||"",onChange:a=>G({...F,phone:a.target.value}),className:"bg-white/5 border-white/10"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Secondary Phone")}),(0,b.jsx)(n.Input,{value:F.phone2||"",onChange:a=>G({...F,phone2:a.target.value}),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Photo")}),(0,b.jsx)(w.ImageUpload,{value:F.avatar||"",onChange:a=>G({...F,avatar:a}),path:"technicians"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Email")}),(0,b.jsx)(n.Input,{value:F.email||"",onChange:a=>G({...F,email:a.target.value}),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Specialization")}),(0,b.jsx)("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-2",children:y.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/5 border border-white/10",children:[(0,b.jsx)(r.Checkbox,{id:`edit-spec-${a}`,checked:F.specialization?.includes(a)||!1,onCheckedChange:()=>{let b=F.specialization?.includes(a)?(F.specialization||[]).filter(b=>b!==a):[...F.specialization||[],a];G({...F,specialization:b})},className:"border-white/20 data-[state=checked]:bg-cyan-500 data-[state=checked]:text-black"}),(0,b.jsx)("label",{htmlFor:`edit-spec-${a}`,className:"text-xs text-white/80",children:a})]},a))}),F.specialization&&F.specialization.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 pt-1",children:F.specialization.map((a,c)=>(0,b.jsx)("span",{className:"px-2 py-0.5 bg-cyan-500/10 text-cyan-400 rounded-full text-xs",children:a},`${a}-${c}`))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:a("Status")}),(0,b.jsxs)(q.Select,{value:F.status,onValueChange:a=>G({...F,status:a}),children:[(0,b.jsx)(q.SelectTrigger,{className:"bg-white/5 border-white/10 text-white hover:bg-white/10 focus-visible:border-cyan-500 focus-visible:ring-cyan-500/30 outline-none rounded-lg",children:(0,b.jsx)(q.SelectValue,{})}),(0,b.jsxs)(q.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,b.jsx)(q.SelectItem,{value:"Active",children:a("Active")}),(0,b.jsx)(q.SelectItem,{value:"Inactive",children:a("Inactive")})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-4 border-t border-white/10",children:[(0,b.jsxs)(o.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Shield,{className:"w-4 h-4 text-cyan-500"})," ",a("Permissions")]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.keys(x).map(c=>(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/5 border border-white/10",children:[(0,b.jsx)(r.Checkbox,{id:`edit-perm-${c}`,checked:F.permissions?.[c]??x[c],onCheckedChange:()=>{F&&G(a=>a?{...a,permissions:{...a.permissions,[c]:!a.permissions[c]}}:null)},className:"border-white/20 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500 data-[state=checked]:text-black"}),(0,b.jsx)("label",{htmlFor:`edit-perm-${c}`,className:"text-sm text-white/80",children:a(c.replace(/([A-Z])/g," $1").trim())})]},c))})]})]}),(0,b.jsxs)(f.DialogFooter,{children:[(0,b.jsx)(p.Button,{variant:"outline",onClick:()=>G(null),className:"border-white/10 text-white hover:bg-white/10",children:a("Cancel")}),(0,b.jsxs)(p.Button,{onClick:ac,className:"bg-cyan-500 hover:bg-cyan-400 text-black",children:[(0,b.jsx)(h.Save,{className:"w-4 h-4 mr-2"}),a("Save Changes")]})]})]})})]})]}):null}a.s(["default",()=>z],59383)}];

//# sourceMappingURL=src_app_admin_technicians_page_tsx_a1119629._.js.map