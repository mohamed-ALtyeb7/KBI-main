module.exports=[32082,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);function e({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,d.cn)("w-full caption-bottom text-sm",a),...c})})}function f({className:a,...c}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,d.cn)("[&_tr]:border-b",a),...c})}function g({className:a,...c}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,d.cn)("[&_tr:last-child]:border-0",a),...c})}function h({className:a,...c}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,d.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...c})}function i({className:a,...c}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,d.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}function j({className:a,...c}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,d.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}var k=a.i(66718),l=a.i(80701),m=a.i(99570),n=a.i(86304),o=a.i(14574),p=a.i(87532),q=a.i(70106);let r=(0,q.default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var s=a.i(46842),t=a.i(41710),u=a.i(81560),v=a.i(77156),w=a.i(16201),x=a.i(73570);let y=(0,q.default)("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);var z=a.i(15618),A=a.i(45222);function B(a,b){var c,d;let e,f,g,h=(c=a,d=b,f=((e=(e=c.replace(/\D/g,"")).replace(/^0+/,"")).startsWith("971")||(e=`971${e}`),e),g=encodeURIComponent(d),`https://wa.me/${f}?text=${g}`);window.open(h,"_blank","noopener,noreferrer")}let C=(a,b,c)=>`Ø£Ø®Ø¨Ø§Ø± Ø³Ø§Ø±Ø©! ðŸŽ‰

ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ†ÙŠ *${b}* Ù„Ø·Ù„Ø¨Ùƒ #${a}

ðŸ“ž Ù„Ù„ØªÙˆØ§ØµÙ„: ${c}

Ø³ÙŠØµÙ„ Ø¥Ù„ÙŠÙƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹!`,D=(a,b)=>`âœ… ØªÙ… Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø¨Ù†Ø¬Ø§Ø­!

Ø·Ù„Ø¨: #${a}

â­ Ù‚ÙŠÙ‘Ù… ØªØ¬Ø±Ø¨ØªÙƒ: ${b}

Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±Ùƒ KBI Repair!`;var E=a.i(1406),F=a.i(35732);a.i(69387);var G=a.i(60574),H=a.i(58712);a.i(30485);var I=a.i(31052),J=a.i(94632),K=a.i(1312);function L(a){let d=(0,K.useT)(),{order:e,items:f,invoiceNumber:g,invoiceDate:h,language:i,discount:j=0,vatEnabled:k=!1,vatRate:l=0,warrantyPeriod:m="3 months",adminNotes:n="",disclaimerText:o=d("Payment due upon completion of repair.")}=a,p=(0,c.useMemo)(()=>{let a=f.reduce((a,b)=>a+Number(b.total||b.unitPrice*b.quantity),0),b=a-Number(j||0),c=k?b*Number(l||0):0;return{subtotal:a,vatAmount:c,finalTotal:b+c}},[f,j,k,l]),q=(0,c.useMemo)(()=>{let a=`KBI Invoice ${g} | Order ${e?.orderId||e?.id}`;return`https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=${encodeURIComponent(a)}`},[g,e]),r=()=>(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xl font-bold",children:"KBI"}),(0,b.jsx)("p",{className:"text-sm",children:d("On-Site Repair Service")}),(0,b.jsx)("p",{className:"text-sm",children:"Abu Dhabi â€“ UAE"}),(0,b.jsx)("p",{className:"text-sm",children:"+971 50 731 3446"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"font-semibold",children:[d("Invoice Number"),": ",g]}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Order ID"),": ",e?.orderId||e?.id]}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Invoice Date"),": ","string"==typeof h?h:new Date(h).toLocaleDateString()]})]})]}),s=()=>(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Customer Information")}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Customer Name"),": ",e?.customerName]}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Phone Number"),": ",e?.customerPhone]}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Service Address"),": ",e?.location||e?.address||""]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Device Information")}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Device Type"),": ",e?.deviceType||e?.device]}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Brand"),": ",e?.brand]}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Model"),": ",e?.model]}),(0,b.jsxs)("p",{className:"text-sm",children:[d("Serial Number (optional)"),": ",e?.serial||""]})]})]}),t=()=>(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 border-b py-2 text-xs font-semibold",children:[(0,b.jsx)("div",{className:"col-span-5",children:d("Description")}),(0,b.jsx)("div",{className:"col-span-2",children:d("Type")}),(0,b.jsx)("div",{className:"col-span-1 text-right",children:d("Qty")}),(0,b.jsx)("div",{className:"col-span-2 text-right",children:d("Unit Price (AED)")}),(0,b.jsx)("div",{className:"col-span-2 text-right",children:d("Total (AED)")})]}),f.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 border-b py-2 text-sm",children:[(0,b.jsx)("div",{className:"col-span-5",children:a.description}),(0,b.jsx)("div",{className:"col-span-2",children:a.category||""}),(0,b.jsx)("div",{className:"col-span-1 text-right",children:a.quantity}),(0,b.jsx)("div",{className:"col-span-2 text-right",children:Number(a.unitPrice).toFixed(2)}),(0,b.jsx)("div",{className:"col-span-2 text-right",children:Number(a.total||a.unitPrice*a.quantity).toFixed(2)})]},c))]}),u=()=>(0,b.jsx)("div",{className:"mt-4 w-full flex justify-end",children:(0,b.jsxs)("div",{className:"w-64 space-y-1 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:d("Subtotal")}),(0,b.jsx)("span",{children:p.subtotal.toFixed(2)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:d("Discount")}),(0,b.jsx)("span",{children:Number(j||0).toFixed(2)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:d("VAT")}),(0,b.jsx)("span",{children:p.vatAmount.toFixed(2)})]}),(0,b.jsxs)("div",{className:"flex justify-between font-semibold",children:[(0,b.jsx)("span",{children:d("Final Total Price (AED)")}),(0,b.jsx)("span",{children:p.finalTotal.toFixed(2)})]})]})}),v=()=>(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold mb-1",children:d("Warranty & Notes")}),(0,b.jsxs)("p",{children:[d("Warranty Period"),": ",m]}),n?(0,b.jsxs)("p",{className:"mt-2",children:[d("Admin Notes"),": ",n]}):null]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsx)("img",{src:q,alt:"QR",className:"inline-block"})})]}),w=()=>(0,b.jsxs)("div",{className:"mt-6 pt-4 border-t text-sm",children:[(0,b.jsx)("p",{children:o}),(0,b.jsx)("p",{className:"mt-1",children:d("Thank you for choosing KBI.")})]}),x=()=>(0,b.jsxs)("div",{className:"bg-white text-black p-6 rounded shadow-sm",children:[(0,b.jsx)(r,{}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(s,{})}),(0,b.jsx)(t,{}),(0,b.jsx)(u,{}),(0,b.jsx)(v,{}),(0,b.jsx)(w,{}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"border-t pt-6",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Customer Signature")}),(0,b.jsx)("div",{className:"h-16 border rounded"})]}),(0,b.jsxs)("div",{className:"border-t pt-6",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Technician Signature")}),(0,b.jsx)("div",{className:"h-16 border rounded"})]})]})]});return"both"===i?(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)(x,{}),(0,b.jsxs)("div",{dir:"rtl",className:"bg-white text-black p-6 rounded shadow-sm",children:[(0,b.jsx)(r,{}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(s,{})}),(0,b.jsx)(t,{}),(0,b.jsx)(u,{}),(0,b.jsx)(v,{}),(0,b.jsx)(w,{}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"border-t pt-6",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Customer Signature")}),(0,b.jsx)("div",{className:"h-16 border rounded"})]}),(0,b.jsxs)("div",{className:"border-t pt-6",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Technician Signature")}),(0,b.jsx)("div",{className:"h-16 border rounded"})]})]})]})]}):"ar"===i?(0,b.jsxs)("div",{dir:"rtl",className:"bg-white text-black p-6 rounded shadow-sm",children:[(0,b.jsx)(r,{}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(s,{})}),(0,b.jsx)(t,{}),(0,b.jsx)(u,{}),(0,b.jsx)(v,{}),(0,b.jsx)(w,{}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"border-t pt-6",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Customer Signature")}),(0,b.jsx)("div",{className:"h-16 border rounded"})]}),(0,b.jsxs)("div",{className:"border-t pt-6",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:d("Technician Signature")}),(0,b.jsx)("div",{className:"h-16 border rounded"})]})]})]}):(0,b.jsx)(x,{})}var M=a.i(77430),N=a.i(30003),O=a.i(62591);let P={pending:"bg-yellow-500/20 text-yellow-500 border-yellow-500/50",in_progress:"bg-blue-500/20 text-blue-500 border-blue-500/50",waiting_parts:"bg-orange-500/20 text-orange-500 border-orange-500/50",completed:"bg-green-500/20 text-green-500 border-green-500/50",delivered:"bg-purple-500/20 text-purple-500 border-purple-500/50",cancelled:"bg-red-500/20 text-red-500 border-red-500/50"};function Q(){let a,q,Q,R,S,T=(0,K.useT)(),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)([]),[Y,Z]=(0,c.useState)([]),[$,_]=(0,c.useState)(""),[aa,ab]=(0,c.useState)("all"),[ac,ad]=(0,c.useState)(!0),[ae,af]=(0,c.useState)(null),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(""),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(""),[ao,ap]=(0,c.useState)("en"),[aq,ar]=(0,c.useState)("0"),[as,at]=(0,c.useState)(!1),[au,av]=(0,c.useState)("0"),[aw,ax]=(0,c.useState)("3 months"),[ay,az]=(0,c.useState)(""),[aA,aB]=(0,c.useState)("Payment due upon completion of repair."),[aC,aD]=(0,c.useState)(!1),[aE,aF]=(0,c.useState)(""),[aG,aH]=(0,c.useState)(null),[aI,aJ]=(0,c.useState)(!1),[aK,aL]=(0,c.useState)(""),[aM,aN]=(0,c.useState)(""),[aO,aP]=(0,c.useState)(""),[aQ,aR]=(0,c.useState)(""),[aS]=(0,c.useState)(10),[aT,aU]=(0,c.useState)(1);(0,c.useEffect)(()=>{let a=(0,I.onAuthStateChanged)(H.auth,a=>{a&&(V(!0),(0,O.getUserRole)(a.uid).then(aH))});if(H.isMockMode)return X([]),Z([]),ad(!1),()=>{a()};let b=(0,G.query)((0,G.collection)(H.db,"orders"),(0,G.orderBy)("createdAt","desc")),c=(0,G.onSnapshot)(b,a=>{X(a.docs.map(a=>{let b=a.data();return{id:a.id,orderId:b.orderId||a.id,customerName:b.customerName||b.name||"Unknown",customerPhone:b.customerPhone||b.phone||"",deviceType:b.deviceType||"Device",brand:b.brand||"",model:b.model||"",issue:b.issue||b.issueType||"",status:aV(b.status),technicianId:b.technicianId,technicianName:b.technicianName||b.technician,createdAt:b.createdAt,estimatedCompletion:b.estimatedCompletion,price:b.price,notes:b.notes,statusHistory:b.statusHistory}})),ad(!1)},a=>{(0,M.toast)({title:T("Failed to load orders"),description:a?.message||T("Please try again")}),ad(!1)}),d=(0,G.onSnapshot)((0,G.collection)(H.db,"technicians"),a=>{Z(a.docs.map(a=>({id:a.id,...a.data()})))},a=>{(0,M.toast)({title:T("Failed to load technicians"),description:a?.message||T("Please try again")})});return()=>{a(),c(),d()}},[]);let aV=a=>{if(!a)return"pending";let b=a.toLowerCase().replace(/\s+/g,"_");return"order_created"===b||"pending"===b?"pending":"in_progress"===b?"in_progress":"waiting_parts"===b?"waiting_parts":"completed"===b?"completed":"delivered"===b?"delivered":"cancelled"===b?"cancelled":"pending"},aW=a=>{let b=[],c=Number(a.price||0);return c>0&&b.push({description:a.issue||"Repair Service",category:"service",quantity:1,unitPrice:c,total:c}),[...b,...a.invoiceItems||[]]},aX=async()=>{let a=(0,G.doc)(H.db,"counters","invoices");return await (0,G.runTransaction)(H.db,async b=>{let c=await b.get(a),d=c.exists()?Number(c.data().current||0):0;return d+=1,b.set(a,{current:d},{merge:!0}),`INV-${String(d).padStart(6,"0")}`})},aY=async()=>{ae&&(am||an(await aX()),al(!0))},aZ=async()=>{if(!ae)return;let a=Number(aq||0),b=Number(au||0),c=aW(ae).reduce((a,b)=>a+Number(b.total||b.unitPrice*b.quantity),0),d=c-a,e=as?d*b:0,f=(0,G.doc)(H.db,"orders",ae.id);await (0,G.updateDoc)(f,{invoice:{invoiceNumber:am,invoiceDate:G.Timestamp.now(),status:"finalized",generatedBy:"admin",discount:a,vatRate:b,vatEnabled:as,warrantyPeriod:aw,adminNotes:ay,disclaimerText:aA,subtotal:c,total:d+e,language:ao,history:(0,G.arrayUnion)({action:"finalized",by:"admin",at:G.Timestamp.now()})},updatedAt:G.Timestamp.now()}),aD(!0)},a$=async()=>{if(!ae||!aE)return;let a=(0,G.doc)(H.db,"orders",ae.id);await (0,G.updateDoc)(a,{invoice:{...ae.invoice,history:(0,G.arrayUnion)({action:"override",by:"admin",at:G.Timestamp.now(),note:aE})},updatedAt:G.Timestamp.now()}),aF("")};if(!U)return null;let a_=W.filter(a=>{let b=a.customerName.toLowerCase().includes($.toLowerCase())||a.orderId.toLowerCase().includes($.toLowerCase())||a.customerPhone.includes($),c="all"===aa||a.status===aa;return b&&c}),a0=async(a,b)=>{let c=W.find(b=>b.id===a),d={status:b,timestamp:G.Timestamp.now(),note:`${T("Status updated to")} ${"in_progress"===b?T("In Progress"):"waiting_parts"===b?T("Waiting Parts"):"completed"===b?T("Completed"):"delivered"===b?T("Delivered"):"cancelled"===b?T("Cancelled"):T("Pending")}`};try{await (0,G.updateDoc)((0,G.doc)(H.db,"orders",a),{status:b,statusHistory:(0,G.arrayUnion)(d)}),(0,M.toast)({title:T("Status updated"),description:`${T("Order")} ${c?.orderId} ${T("now")} ${a7(b)}`})}catch(a){(0,M.toast)({title:T("Failed to update status"),description:a?.message||T("Please try again")});return}if(c?.customerPhone){let a="";switch(b){case"in_progress":a=C(c.orderId,c.technicianName||"Technician","");break;case"completed":a=D(c.orderId,`kbi.ae/rate?orderId=${c.orderId}`)}a&&(B(c.customerPhone,a),(0,M.toast)({title:T("WhatsApp opened"),description:T("Customer notified")}))}let e=H.auth.currentUser;e&&(0,E.logAction)(E.AuditActions.ORDER_UPDATED,"order",e.uid,e.email||"",{targetId:a,targetType:"order",details:{newStatus:b}})},a1=async(a,b)=>{let c=Y.find(a=>a.id===b);if(!c)return;let d=W.find(b=>b.id===a),e={status:"in_progress",timestamp:G.Timestamp.now(),note:`${T("Assigned to technician")} ${c.name}`};try{await (0,G.updateDoc)((0,G.doc)(H.db,"orders",a),{technicianId:b,technicianName:c.name,status:"in_progress",statusHistory:(0,G.arrayUnion)(e)}),(0,M.toast)({title:T("Technician assigned"),description:`${c.name} â€¢ ${T("Order")} ${d?.orderId}`})}catch(a){(0,M.toast)({title:T("Failed to assign"),description:a?.message||T("Please try again")});return}if(d?.customerPhone){let a=C(d.orderId,c.name,"");B(d.customerPhone,a),(0,M.toast)({title:T("WhatsApp opened"),description:T("Customer notified")})}let f=H.auth.currentUser;f&&(0,E.logAction)(E.AuditActions.ORDER_UPDATED,"order",f.uid,f.email||"",{targetId:a,targetType:"order",details:{assignedTo:c.name}})},a2=async a=>{if(confirm(T("Are you sure you want to delete this order?")))try{await (0,G.deleteDoc)((0,G.doc)(H.db,"orders",a)),(0,M.toast)({title:T("Order deleted"),description:a});let b=H.auth.currentUser;b&&(0,E.logAction)(E.AuditActions.ORDER_DELETED,"order",b.uid,b.email||"",{targetId:a,targetType:"order"})}catch(a){(0,M.toast)({title:T("Delete failed"),description:a?.message||T("Please try again")})}},a3=(a,b)=>{if(!a.customerPhone)return void(0,M.toast)({title:T("No phone number available"),description:T("Add customer phone to order")});let c="";switch(b){case"confirmation":let d,e;d=a.orderId,e=a.customerName,c=`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${e}! ðŸ‘‹

ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø±Ù‚Ù… #${d} Ø¨Ù†Ø¬Ø§Ø­ âœ…

Ø³ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† ÙÙ†ÙŠ Ù„Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.

Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©: kbi.ae/track

KBI Repair Services`;break;case"assigned":c=C(a.orderId,a.technicianName||"Technician","");break;case"complete":c=D(a.orderId,`kbi.ae/rate?orderId=${a.orderId}`);break;default:c=`Order #${a.orderId} update`}B(a.customerPhone,c),(0,M.toast)({title:T("WhatsApp opened"),description:T("Customer notified")})},a4=async()=>{if(!ae||!ai)return;let a=parseInt(ai,10);if(isNaN(a)||a<0)return;let b=new Date(Date.now()+6e4*a).toISOString();await (0,G.updateDoc)((0,G.doc)(H.db,"orders",ae.id),{estimatedCompletion:b,updatedAt:G.Timestamp.now()}),aj("")},a5=Math.ceil(a_.length/aS),a6=a_.slice((aT-1)*aS,aT*aS),a7=a=>"in_progress"===a?T("In Progress"):"waiting_parts"===a?T("Waiting Parts"):"completed"===a?T("Completed"):"delivered"===a?T("Delivered"):"cancelled"===a?T("Cancelled"):T("Pending"),a8=async a=>{try{if(H.isMockMode){X(b=>b.map(b=>b.id===a.id?{...b,...b,approvedPrice:b.proposedPrice??null,approvedDurationMinutes:b.proposedDurationMinutes??null,approvedByAdminId:"mock_admin",approvedAt:new Date().toISOString(),pricingStatus:"approved"}:b)),(0,M.toast)({title:T("Proposal approved"),description:a.orderId});return}let b=H.auth.currentUser?.uid||"";await (0,N.approveOrderPricing)(a.id,b),(0,M.toast)({title:T("Proposal approved"),description:a.orderId})}catch(a){(0,M.toast)({title:T("Failed to approve"),description:a?.message||T("Please try again")})}},a9=async a=>{try{if(H.isMockMode){X(b=>b.map(b=>b.id===a.id?{...b,...b,pricingStatus:"rejected"}:b)),(0,M.toast)({title:T("Proposal rejected"),description:a.orderId});return}await (0,N.rejectOrderPricing)(a.id),(0,M.toast)({title:T("Proposal rejected"),description:a.orderId})}catch(a){(0,M.toast)({title:T("Failed to reject"),description:a?.message||T("Please try again")})}},ba=async a=>{try{if("super_admin"!==aG)return void(0,M.toast)({title:T("Not allowed"),description:T("Only Super Admin can counter")});if(H.isMockMode){X(b=>b.map(b=>b.id===a.id?{...b,...b,counterPrice:parseFloat(aK||"0")||null,counterDurationMinutes:parseFloat(aM||"0")||null,counterArrivalETA:aO||null,pricingStatus:"countered"}:b)),aJ(!1),aL(""),aN(""),aP(""),aR(""),(0,M.toast)({title:T("Counter saved"),description:a.orderId});return}let b=H.auth.currentUser?.uid||"";await (0,N.counterOfferPricing)(a.id,b,{counterPrice:parseFloat(aK||"0")||null,counterDurationMinutes:parseFloat(aM||"0")||null,counterArrivalETA:aO||null,counterNote:aQ}),aJ(!1),aL(""),aN(""),aP(""),aR(""),(0,M.toast)({title:T("Counter saved"),description:a.orderId})}catch(a){(0,M.toast)({title:T("Failed to counter"),description:a?.message||T("Please try again")})}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-white",children:T("Orders Management")}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(m.Button,{variant:"outline",onClick:()=>{let a=[T("Order ID"),T("Customer"),T("Phone"),T("Device"),T("Issue"),T("Status"),T("Technician"),T("Created"),T("Price")],b=a_.map(a=>[a.orderId,a.customerName,a.customerPhone,`"${a.brand} ${a.model}"`,`"${a.issue}"`,a.status,a.technicianName||T("Unassigned"),a.createdAt?.seconds?new Date(1e3*a.createdAt.seconds).toISOString():"",a.price||""]),c=encodeURI("data:text/csv;charset=utf-8,"+a.join(",")+"\n"+b.map(a=>a.join(",")).join("\n")),d=document.createElement("a");d.setAttribute("href",c),d.setAttribute("download",`orders_export_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(d),d.click(),document.body.removeChild(d)},children:[(0,b.jsx)(y,{className:"mr-2 h-4 w-4"})," ",T("Export CSV")]}),(0,b.jsxs)(m.Button,{children:[(0,b.jsx)(z.Plus,{className:"mr-2 h-4 w-4"})," ",T("New Order")]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,b.jsx)(p.Search,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-white/50"}),(0,b.jsx)(k.Input,{placeholder:T("Search orders..."),className:"pl-9 bg-white/5 border-white/10 text-white",value:$,onChange:a=>_(a.target.value)})]}),(0,b.jsxs)(l.Select,{value:aa,onValueChange:ab,children:[(0,b.jsx)(l.SelectTrigger,{className:"w-[180px] bg-white/5 border-white/10 text-white hover:bg-white/10 focus-visible:border-cyan-500 focus-visible:ring-cyan-500/30 outline-none rounded-lg",children:(0,b.jsx)(l.SelectValue,{placeholder:T("Filter by status")})}),(0,b.jsxs)(l.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,b.jsx)(l.SelectItem,{value:"all",children:T("All")}),(0,b.jsx)(l.SelectItem,{value:"pending",children:T("Pending")}),(0,b.jsx)(l.SelectItem,{value:"in_progress",children:T("In Progress")}),(0,b.jsx)(l.SelectItem,{value:"waiting_parts",children:T("Waiting Parts")}),(0,b.jsx)(l.SelectItem,{value:"completed",children:T("Completed")}),(0,b.jsx)(l.SelectItem,{value:"delivered",children:T("Delivered")}),(0,b.jsx)(l.SelectItem,{value:"cancelled",children:T("Cancelled")})]})]})]}),(0,b.jsx)("div",{className:"rounded-md border border-white/10 bg-white/5 overflow-hidden",children:(0,b.jsxs)(e,{children:[(0,b.jsx)(f,{className:"bg-white/5",children:(0,b.jsxs)(h,{className:"border-white/10 hover:bg-white/5",children:[(0,b.jsx)(i,{className:"text-white",children:T("Order ID")}),(0,b.jsx)(i,{className:"text-white",children:T("Customer")}),(0,b.jsx)(i,{className:"text-white",children:T("Device")}),(0,b.jsx)(i,{className:"text-white",children:T("Issue")}),(0,b.jsx)(i,{className:"text-white",children:T("Status")}),(0,b.jsx)(i,{className:"text-white",children:T("Technician")}),(0,b.jsx)(i,{className:"text-white",children:T("Created")}),(0,b.jsx)(i,{className:"text-white text-right",children:T("Actions")})]})}),(0,b.jsx)(g,{children:0===a_.length?(0,b.jsx)(h,{children:(0,b.jsx)(j,{colSpan:8,className:"text-center py-8 text-white/50",children:T("No orders found")})}):a6.map(a=>(0,b.jsxs)(h,{className:"border-white/10 hover:bg-white/5",children:[(0,b.jsx)(j,{className:"font-medium text-white",children:a.orderId}),(0,b.jsx)(j,{children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-white",children:a.customerName}),(0,b.jsx)("span",{className:"text-xs text-white/50",children:a.customerPhone})]})}),(0,b.jsxs)(j,{className:"text-white",children:[a.brand," ",a.model]}),(0,b.jsx)(j,{className:"text-white",children:a.issue}),(0,b.jsx)(j,{children:(0,b.jsx)(n.Badge,{variant:"outline",className:(0,d.cn)("capitalize",P[a.status]),children:a7(a.status)})}),(0,b.jsx)(j,{className:"text-white",children:a.technicianName?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(s.User,{className:"h-3 w-3 text-cyan-400"}),(0,b.jsx)("span",{children:a.technicianName})]}):(0,b.jsx)("span",{className:"text-white/30 italic",children:T("Unassigned")})}),(0,b.jsx)(j,{className:"text-white/60",children:a.createdAt?.seconds?(0,J.formatDistanceToNow)(new Date(1e3*a.createdAt.seconds),{addSuffix:!0}):T("Just now")}),(0,b.jsx)(j,{className:"text-right",children:(0,b.jsxs)(F.DropdownMenu,{children:[(0,b.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(m.Button,{variant:"ghost",className:"h-8 w-8 p-0 text-white/70 hover:text-white",children:[(0,b.jsx)("span",{className:"sr-only",children:T("Open menu")}),(0,b.jsx)(r,{className:"h-4 w-4"})]})}),(0,b.jsxs)(F.DropdownMenuContent,{align:"end",className:"bg-zinc-900 border-zinc-800 text-white",children:[(0,b.jsx)(F.DropdownMenuLabel,{children:T("Actions")}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>{af(a),ah(!0)},children:[(0,b.jsx)(v.Eye,{className:"mr-2 h-4 w-4"})," ",T("View Details")]}),(0,b.jsx)(F.DropdownMenuSeparator,{className:"bg-zinc-800"}),(0,b.jsx)(F.DropdownMenuLabel,{children:T("Update Status")}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a0(a.id,"in_progress"),children:[(0,b.jsx)(t.Clock,{className:"mr-2 h-4 w-4"})," ",T("In Progress")]}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a0(a.id,"completed"),children:[(0,b.jsx)(w.CheckCircle,{className:"mr-2 h-4 w-4"})," ",T("Completed")]}),"proposed"===a.pricingStatus&&"super_admin"===aG&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(F.DropdownMenuSeparator,{className:"bg-zinc-800"}),(0,b.jsx)(F.DropdownMenuLabel,{children:T("Pricing Proposal")}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a8(a),children:[(0,b.jsx)(w.CheckCircle,{className:"mr-2 h-4 w-4"})," ",T("Approve Proposal")]}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a9(a),children:[(0,b.jsx)(x.AlertTriangle,{className:"mr-2 h-4 w-4"})," ",T("Reject Proposal")]}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>{af(a),aJ(!0)},children:[(0,b.jsx)(x.AlertTriangle,{className:"mr-2 h-4 w-4"})," ",T("Counter Offer")]})]}),(0,b.jsx)(F.DropdownMenuSeparator,{className:"bg-zinc-800"}),(0,b.jsx)(F.DropdownMenuLabel,{children:T("Assign Technician")}),Y.map(c=>(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a1(a.id,c.id),children:[(0,b.jsx)(s.User,{className:"mr-2 h-4 w-4"})," ",c.name]},c.id)),(0,b.jsx)(F.DropdownMenuSeparator,{className:"bg-zinc-800"}),(0,b.jsx)(F.DropdownMenuLabel,{children:T("Notify Customer")}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a3(a,"confirmation"),children:[(0,b.jsx)(A.MessageCircle,{className:"mr-2 h-4 w-4"})," ",T("Order Received")]}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a3(a,"assigned"),children:[(0,b.jsx)(A.MessageCircle,{className:"mr-2 h-4 w-4"})," ",T("Technician Assigned")]}),(0,b.jsxs)(F.DropdownMenuItem,{onClick:()=>a3(a,"complete"),children:[(0,b.jsx)(A.MessageCircle,{className:"mr-2 h-4 w-4"})," ",T("Repair Complete")]}),(0,b.jsx)(F.DropdownMenuSeparator,{className:"bg-zinc-800"}),(0,b.jsxs)(F.DropdownMenuItem,{className:"text-red-500 hover:text-red-400",onClick:()=>a2(a.id),children:[(0,b.jsx)(u.Trash2,{className:"mr-2 h-4 w-4"})," ",T("Delete Order")]})]})]})})]},a.id))})]})}),a5>1&&(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(m.Button,{variant:"outline",size:"sm",onClick:()=>aU(a=>Math.max(1,a-1)),disabled:1===aT,className:"bg-white/5 border-white/10 hover:bg-white/10 text-white",children:T("Previous")}),(0,b.jsxs)("span",{className:"text-sm text-white/50",children:[T("Page")," ",aT," ",T("of")," ",a5]}),(0,b.jsx)(m.Button,{variant:"outline",size:"sm",onClick:()=>aU(a=>Math.min(a5,a+1)),disabled:aT===a5,className:"bg-white/5 border-white/10 hover:bg-white/10 text-white",children:T("Next")})]}),(0,b.jsx)(o.Dialog,{open:ag,onOpenChange:ah,children:(0,b.jsxs)(o.DialogContent,{className:"bg-zinc-950 border-zinc-800 text-white sm:max-w-[600px]",children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsxs)(o.DialogTitle,{children:[T("Order Details"),": ",ae?.orderId]})}),ae&&(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Customer")}),(0,b.jsx)("p",{className:"font-semibold",children:ae.customerName}),(0,b.jsx)("p",{className:"text-sm text-white/70",children:ae.customerPhone})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Device")}),(0,b.jsxs)("p",{className:"font-semibold",children:[ae.brand," ",ae.model]}),(0,b.jsx)("p",{className:"text-sm text-white/70",children:ae.deviceType})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Issue")}),(0,b.jsx)("p",{className:"font-semibold",children:ae.issue})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Status")}),(0,b.jsx)(n.Badge,{variant:"outline",className:(0,d.cn)("capitalize",P[ae.status]),children:ae.status.replace("_"," ")})]})]}),ae.pricingStatus&&(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4 p-3 rounded border border-white/10 bg-white/5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Pricing Status")}),(0,b.jsx)("p",{className:"font-semibold",children:ae.pricingStatus})]}),ae.proposedPrice&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Proposed Price")}),(0,b.jsxs)("p",{className:"font-semibold",children:["AED ",ae.proposedPrice]})]}),ae.proposedPriceMin&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Proposed Range")}),(0,b.jsxs)("p",{className:"font-semibold",children:["AED ",ae.proposedPriceMin," - ",ae.proposedPriceMax]})]}),ae.proposedBreakdown&&(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Breakdown")}),(0,b.jsxs)("div",{className:"text-white/80 text-sm",children:[T("Labor"),": ",ae.proposedBreakdown.labor||0," â€¢ ",T("Parts"),": ",ae.proposedBreakdown.parts||0," â€¢ ",T("Inspection"),": ",ae.proposedBreakdown.inspection||0]})]}),ae.proposalMediaUrls?.length>0&&(0,b.jsx)("div",{className:"col-span-2 grid grid-cols-3 gap-2",children:(ae.proposalMediaUrls||[]).map((a,c)=>(0,b.jsx)("a",{href:a,target:"_blank",rel:"noreferrer",className:"block aspect-square rounded border border-white/10 overflow-hidden",children:(0,b.jsx)("img",{src:a,alt:"media",className:"w-full h-full object-cover"})},c))}),ae.proposedDurationMinutes&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Proposed Duration")}),(0,b.jsxs)("p",{className:"font-semibold",children:[ae.proposedDurationMinutes," ",T("minutes")]})]}),ae.proposedExpiresAt&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Proposal Expires")}),(0,b.jsx)("p",{className:"font-semibold",children:(a=ae.proposedExpiresAt,(q=a?.toDate?.()?a.toDate():"string"==typeof a?new Date(a):null)?q.toLocaleString():T("N/A"))})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Approval Tier")}),(0,b.jsx)("p",{className:"font-semibold",children:null==(Q=ae?.proposedBreakdown?Number(ae.proposedBreakdown.labor||0)+Number(ae.proposedBreakdown.parts||0)+Number(ae.proposedBreakdown.inspection||0):ae?.proposedPriceMax??ae?.proposedPriceMin??ae?.proposedPrice??null)?T("Unknown"):Q<200?T("Auto-approve recommended (<200 AED)"):Q<=500?T("Admin review (200â€“500 AED)"):T("Super Admin review (>500 AED)")})]}),ae.proposalNote&&(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("Technician Note")}),(0,b.jsx)("p",{className:"text-white/80",children:ae.proposalNote})]}),"proposed"===ae.pricingStatus&&"super_admin"===aG&&(0,b.jsxs)("div",{className:"col-span-2 flex gap-2",children:[(0,b.jsx)(m.Button,{onClick:()=>a8(ae),className:"bg-green-600 text-white",children:T("Approve Proposal")}),(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>a9(ae),children:T("Reject Proposal")}),(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>aJ(!0),children:T("Counter Offer")})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-1",children:T("ETA (minutes)")}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(k.Input,{type:"number",value:ai,onChange:a=>aj(a.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,b.jsx)(m.Button,{onClick:a4,className:"bg-cyan-500 hover:bg-cyan-400 text-black",children:T("Save")})]})]}),(0,b.jsx)("div",{children:ae.estimatedCompletion&&(0,b.jsxs)("div",{className:"p-3 rounded border flex items-center gap-3 transition-colors border-white/10 bg-white/5",children:[(0,b.jsx)(t.Clock,{className:"w-5 h-5 text-cyan-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-white/60",children:T("Remaining Time")}),(0,b.jsx)("p",{className:"text-sm font-mono text-white",children:new Date(ae.estimatedCompletion).toLocaleString()})]})]})})]}),(0,b.jsxs)("div",{className:"mt-6 pt-6 border-t border-white/10",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-4",children:T("Order Timeline")}),(0,b.jsxs)("div",{className:"space-y-0 relative",children:[(0,b.jsx)("div",{className:"absolute left-2.5 top-2 bottom-4 w-0.5 bg-zinc-800"}),(R=[{id:"pending",label:T("Order Placed"),description:T("Order has been created")},{id:"in_progress",label:T("In Repair"),description:T("Technician is working on the device")},{id:"completed",label:T("Repair Completed"),description:T("Device is fixed and ready")},{id:"delivered",label:T("Delivered"),description:T("Device returned to customer")}],S=0,(S="delivered"===ae.status?3:"completed"===ae.status?2:+("in_progress"===ae.status||"waiting_parts"===ae.status),"cancelled"===ae.status)?(0,b.jsxs)("div",{className:"relative flex gap-4 pb-6",children:[(0,b.jsx)("div",{className:"relative z-10 flex h-6 w-6 items-center justify-center rounded-full bg-red-500 ring-4 ring-zinc-950",children:(0,b.jsx)(x.AlertTriangle,{className:"h-3 w-3 text-white"})}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-red-500",children:T("Order Cancelled")}),(0,b.jsx)("p",{className:"text-xs text-white/50",children:T("This order has been cancelled.")})]})]}):R.map((a,c)=>{let e=c<S,f=c===S,g=c>S,h=ae.statusHistory?.find(b=>"pending"===a.id?"pending"===b.status:"in_progress"===a.id?"in_progress"===b.status||"waiting_parts"===b.status:"completed"===a.id?"completed"===b.status:"delivered"===a.id&&"delivered"===b.status);return(0,b.jsxs)("div",{className:(0,d.cn)("relative flex gap-4 pb-8 last:pb-0",g&&"opacity-40"),children:[(0,b.jsx)("div",{className:(0,d.cn)("relative z-10 flex h-6 w-6 items-center justify-center rounded-full ring-4 ring-zinc-950 transition-colors",e?"bg-cyan-500 text-black":f?"bg-cyan-500 ring-cyan-500/20 animate-pulse text-black":"bg-zinc-800 text-white/30"),children:e?(0,b.jsx)(w.CheckCircle,{className:"h-3 w-3"}):f?(0,b.jsx)(t.Clock,{className:"h-3 w-3"}):(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-current"})}),(0,b.jsxs)("div",{className:"flex flex-col -mt-1",children:[(0,b.jsx)("p",{className:(0,d.cn)("text-sm font-medium",f?"text-cyan-400":"text-white"),children:a.label}),(0,b.jsx)("p",{className:"text-xs text-white/50",children:a.description}),(e||f)&&h?.timestamp&&(0,b.jsx)("p",{className:"text-[10px] text-white/30 mt-1",children:new Date(1e3*h.timestamp.seconds).toLocaleString()})]})]},a.id)}))]}),ae.statusHistory&&ae.statusHistory.length>0&&(0,b.jsxs)("div",{className:"mt-6 pt-4 border-t border-white/5",children:[(0,b.jsx)("h5",{className:"text-xs font-medium text-white/40 mb-3 uppercase tracking-wider",children:T("Detailed History")}),(0,b.jsx)("div",{className:"space-y-3 pl-2 border-l border-white/5",children:ae.statusHistory.slice().reverse().map((a,c)=>(0,b.jsxs)("div",{className:"pl-4 relative",children:[(0,b.jsx)("div",{className:"absolute left-[-5px] top-1.5 h-2 w-2 rounded-full bg-white/10"}),(0,b.jsx)("p",{className:"text-xs text-white/70",children:a.note||a.status}),(0,b.jsx)("p",{className:"text-[10px] text-white/30",children:a.timestamp?.seconds?new Date(1e3*a.timestamp.seconds).toLocaleString():T("Just now")})]},c))})]}),(0,b.jsxs)("div",{className:"mt-6 pt-6 border-t border-white/10",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white/50 mb-4",children:T("Invoice")}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(m.Button,{onClick:aY,className:"bg-cyan-500 text-black",disabled:aC||ae.invoice?.status==="finalized",children:T("Generate Final Invoice")}),(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>al(!0),children:T("Preview Invoice")})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>window.print(),children:T("Print Invoice")}),(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>window.print(),children:T("Download as PDF")})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>{let a=ae?.invoice?.total||ae?.totalCost||ae.price||0,b=`Your repair is completed. Final amount: AED ${a}. Please find your invoice attached. Thank you for choosing KBI.`,c=`ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† ØµÙŠØ§Ù†Ø© Ø¬Ù‡Ø§Ø²Ùƒ. Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${a} Ø¯Ø±Ù‡Ù…. ØªØ¬Ø¯ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù…Ø±ÙÙ‚Ø©. Ø´ÙƒØ±Ù‹Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø±Ùƒ KBI.`,d=`${b}

${c}`;ae.customerPhone?(B(ae.customerPhone,d),(0,M.toast)({title:T("WhatsApp opened"),description:T("Invoice sent to customer")})):(0,M.toast)({title:T("No phone number available"),description:T("Add customer phone to order")})},children:T("Resend to Customer")})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)(k.Input,{placeholder:T("Discount"),value:aq,onChange:a=>ar(a.target.value),className:"bg-white/5 border-white/10 text-white",disabled:aC||ae.invoice?.status==="finalized"}),(0,b.jsx)(k.Input,{placeholder:T("Warranty Period"),value:aw,onChange:a=>ax(a.target.value),className:"bg-white/5 border-white/10 text-white",disabled:aC||ae.invoice?.status==="finalized"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:as,onChange:a=>at(a.target.checked),disabled:aC||ae.invoice?.status==="finalized"}),(0,b.jsx)("span",{className:"text-sm text-white",children:T("VAT Enabled")})]}),(0,b.jsx)(k.Input,{placeholder:T("VAT Rate"),value:au,onChange:a=>av(a.target.value),className:"bg-white/5 border-white/10 text-white",disabled:aC||ae.invoice?.status==="finalized"})]}),(0,b.jsx)(k.Input,{placeholder:T("Disclaimer"),value:aA,onChange:a=>aB(a.target.value),className:"bg-white/5 border-white/10 text-white",disabled:aC||ae.invoice?.status==="finalized"}),(0,b.jsx)(k.Input,{placeholder:T("Admin Notes"),value:ay,onChange:a=>az(a.target.value),className:"bg-white/5 border-white/10 text-white",disabled:aC||ae.invoice?.status==="finalized"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,b.jsx)(m.Button,{variant:"en"===ao?"default":"outline",onClick:()=>ap("en"),disabled:aC||ae.invoice?.status==="finalized",children:T("English")}),(0,b.jsx)(m.Button,{variant:"ar"===ao?"default":"outline",onClick:()=>ap("ar"),disabled:aC||ae.invoice?.status==="finalized",children:T("Arabic")}),(0,b.jsx)(m.Button,{variant:"both"===ao?"default":"outline",onClick:()=>ap("both"),disabled:aC||ae.invoice?.status==="finalized",children:T("EN + AR")})]})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,b.jsxs)(n.Badge,{variant:"outline",className:"text-white/70",children:[T("Invoice Status"),": ",ae.invoice?.status||(aC?"finalized":"draft")]}),(0,b.jsx)(m.Button,{onClick:aZ,className:"bg-green-600 text-white",disabled:aC||ae.invoice?.status==="finalized",children:T("Finalize Invoice")}),(0,b.jsx)(k.Input,{placeholder:T("Override reason"),value:aE,onChange:a=>aF(a.target.value),className:"bg-white/5 border-white/10 text-white max-w-xs"}),(0,b.jsx)(m.Button,{variant:"outline",onClick:a$,children:T("Override Edit")})]})]})]})]})]})}),(0,b.jsx)(o.Dialog,{open:ak,onOpenChange:al,children:(0,b.jsxs)(o.DialogContent,{className:"bg-white text-black sm:max-w-[800px]",children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsx)(o.DialogTitle,{children:T("Invoice Preview")})}),ae&&(0,b.jsx)("div",{className:"max-h-[70vh] overflow-auto",children:(0,b.jsx)(L,{order:ae,items:aW(ae),invoiceNumber:am,invoiceDate:new Date().toISOString(),language:ao,discount:Number(aq||0),vatEnabled:as,vatRate:Number(au||0),warrantyPeriod:aw,adminNotes:ay,disclaimerText:aA})}),(0,b.jsxs)(o.DialogFooter,{children:[(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>window.print(),children:T("Print Invoice")}),(0,b.jsx)(m.Button,{onClick:aZ,children:T("Finalize Invoice")})]})]})}),(0,b.jsx)(o.Dialog,{open:aI,onOpenChange:aJ,children:(0,b.jsxs)(o.DialogContent,{className:"bg-zinc-900 border-zinc-800 text-white sm:max-w-[500px]",children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsxs)(o.DialogTitle,{children:[T("Counter Offer"),": ",ae?.orderId]})}),(0,b.jsxs)("div",{className:"grid gap-3",children:[(0,b.jsx)(k.Input,{type:"number",placeholder:T("Counter Price (AED)"),value:aK,onChange:a=>aL(a.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,b.jsx)(k.Input,{type:"number",placeholder:T("Counter Duration (minutes)"),value:aM,onChange:a=>aN(a.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,b.jsx)(k.Input,{type:"text",placeholder:T("Arrival ETA"),value:aO,onChange:a=>aP(a.target.value),className:"bg-white/5 border-white/10 text-white"}),(0,b.jsx)(k.Input,{type:"text",placeholder:T("Note"),value:aQ,onChange:a=>aR(a.target.value),className:"bg-white/5 border-white/10 text-white"})]}),(0,b.jsx)(o.DialogFooter,{children:(0,b.jsx)(m.Button,{onClick:()=>ae&&ba(ae),children:T("Save Counter")})})]})})]})}a.s(["default",()=>Q],32082)}];

//# sourceMappingURL=src_app_admin_orders_page_tsx_3a6cbed4._.js.map