module.exports=[24987,a=>{"use strict";let b=(0,a.i(70106).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},41710,a=>{"use strict";let b=(0,a.i(70106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],41710)},1631,a=>{"use strict";let b=(0,a.i(70106).default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);a.s(["Smartphone",()=>b],1631)},16201,26405,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["default",()=>b],26405),a.s(["CheckCircle",()=>b],16201)},34157,a=>{"use strict";let b=(0,a.i(70106).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["default",()=>b])},6406,a=>{"use strict";var b=a.i(34157);a.s(["CheckIcon",()=>b.default])},77994,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},37738,7827,a=>{"use strict";var b=a.i(72131),c=a.i(50104),d=a.i(70121),e=a.i(11011),f=a.i(87924);function g(a){let g=a+"CollectionProvider",[h,i]=(0,c.createContextScope)(g),[j,k]=h(g,{collectionRef:{current:null},itemMap:new Map}),l=a=>{let{scope:c,children:d}=a,e=b.default.useRef(null),g=b.default.useRef(new Map).current;return(0,f.jsx)(j,{scope:c,itemMap:g,collectionRef:e,children:d})};l.displayName=g;let m=a+"CollectionSlot",n=b.default.forwardRef((a,b)=>{let{scope:c,children:g}=a,h=k(m,c),i=(0,d.useComposedRefs)(b,h.collectionRef);return(0,f.jsx)(e.Slot,{ref:i,children:g})});n.displayName=m;let o=a+"CollectionItemSlot",p="data-radix-collection-item",q=b.default.forwardRef((a,c)=>{let{scope:g,children:h,...i}=a,j=b.default.useRef(null),l=(0,d.useComposedRefs)(c,j),m=k(o,g);return b.default.useEffect(()=>(m.itemMap.set(j,{ref:j,...i}),()=>void m.itemMap.delete(j))),(0,f.jsx)(e.Slot,{...{[p]:""},ref:l,children:h})});return q.displayName=o,[{Provider:l,Slot:n,ItemSlot:q},function(c){let d=k(a+"CollectionConsumer",c);return b.default.useCallback(()=>{let a=d.collectionRef.current;if(!a)return[];let b=Array.from(a.querySelectorAll(`[${p}]`));return Array.from(d.itemMap.values()).sort((a,c)=>b.indexOf(a.ref.current)-b.indexOf(c.ref.current))},[d.collectionRef,d.itemMap])},i]}a.s(["createCollection",()=>g],37738);var h=b.createContext(void 0);function i(a){let c=b.useContext(h);return a||c||"ltr"}a.s(["useDirection",()=>i],7827)},86304,a=>{"use strict";var b=a.i(87924),c=a.i(11011),d=a.i(187),e=a.i(68114);let f=(0,d.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function g({className:a,variant:d,asChild:g=!1,...h}){let i=g?c.Slot:"span";return(0,b.jsx)(i,{"data-slot":"badge",className:(0,e.cn)(f({variant:d}),a),...h})}a.s(["Badge",()=>g])},91119,a=>{"use strict";var b=a.i(87924),c=a.i(68114);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},53407,a=>{"use strict";var b=a.i(1312);function c(){let{lang:a,setLang:c}=(0,b.useLanguage)();return{language:a,setLanguage:c,t:(0,b.useT)()}}a.s(["useLanguage",()=>c])},95477,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(58712);async function d(a){try{let d=(await (0,b.getDoc)((0,b.doc)(c.db,"users",a.uid))).data(),e=d?.technicianId||null;if(!e){let d=(0,b.query)((0,b.collection)(c.db,"technicians"),(0,b.where)("uid","==",a.uid)),f=await (0,b.getDocs)(d);if(f.empty){if(a.email){let d=(0,b.query)((0,b.collection)(c.db,"technicians"),(0,b.where)("email","==",a.email)),f=await (0,b.getDocs)(d);f.empty||(e=f.docs[0].id)}}else e=f.docs[0].id}return e}catch(a){return console.error("Resolve technicianId error:",a),null}}a.s(["getTechnicianIdFromUser",()=>d])},90669,a=>{"use strict";let b=(0,a.i(70106).default)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);a.s(["Activity",()=>b],90669)},24669,a=>{"use strict";let b=(0,a.i(70106).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);a.s(["TrendingUp",()=>b],24669)},1027,a=>{"use strict";let b=(0,a.i(70106).default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);a.s(["Zap",()=>b],1027)},29246,a=>{"use strict";var b=a.i(87924),c=a.i(68114);function d({className:a,...d}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,c.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...d})}a.s(["Textarea",()=>d])},21374,a=>{"use strict";let b=(0,a.i(70106).default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);a.s(["Star",()=>b],21374)},30003,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(58712);async function d(a){return(await (0,b.addDoc)((0,b.collection)(c.db,"notifications"),{...a,read:!1,createdAt:b.Timestamp.now()})).id}async function e(a,d){try{await (0,b.updateDoc)((0,b.doc)(c.db,"orders",a),{...d,updatedAt:(0,b.serverTimestamp)()})}catch(a){throw console.error("Update order error:",a),Error(a.message||"Failed to update order")}}async function f(a,c){let f=c.proposedBreakdown?Number(c.proposedBreakdown.labor||0)+Number(c.proposedBreakdown.parts||0)+Number(c.proposedBreakdown.inspection||0):null,g=c.proposedPriceMax??c.proposedPriceMin??null,h=f??g??null,i=b.Timestamp.fromDate(new Date(Date.now()+1728e5)),j={proposedPrice:c.proposedPriceMax??c.proposedPriceMin??null,proposedPriceMin:c.proposedPriceMin??null,proposedPriceMax:c.proposedPriceMax??null,proposedBreakdown:c.proposedBreakdown??null,proposedDurationMinutes:c.proposedDurationMinutes,proposedArrivalETA:c.proposedArrivalETA??null,proposalNote:c.proposalNote||null,proposalMediaUrls:c.proposalMediaUrls||null,proposedByTechnicianId:c.proposedByTechnicianId,proposedAt:(0,b.serverTimestamp)(),proposedExpiresAt:i,pricingStatus:"proposed"};await e(a,j);try{let b=`Technician proposed pricing for order ${a}`+(null!=h?` • AED ${h}`:"");await d({type:"system",title:"Pricing Proposed",message:b,role:"admin",orderId:a,link:"/admin/orders"}),null!=h&&h>500?await d({type:"system",title:"High-Value Proposal",message:`Order ${a} requires Super Admin review • AED ${h}`,role:"super_admin",orderId:a,link:"/admin/orders"}):null!=h&&h<200&&await d({type:"system",title:"Auto-Approval Candidate",message:`Order ${a} proposed under AED 200 • Consider auto-approve`,role:"admin",orderId:a,link:"/admin/orders"})}catch(a){}}async function g(a,f){let g=await (0,b.getDoc)((0,b.doc)(c.db,"orders",a));if(!g.exists())return;let h=g.data(),i={approvedPrice:h.proposedBreakdown?Number(h.proposedBreakdown.labor||0)+Number(h.proposedBreakdown.parts||0)+Number(h.proposedBreakdown.inspection||0):h.proposedPriceMax??h.proposedPrice??null,approvedDurationMinutes:h.proposedDurationMinutes??null,approvedArrivalETA:h.proposedArrivalETA??null,approvedByAdminId:f,approvedAt:(0,b.serverTimestamp)(),pricingStatus:"approved"};await e(a,i);try{await d({type:"system",title:"Pricing Approved",message:`Pricing approved for order ${a}`,role:"technician",orderId:a,link:"/technician/orders"})}catch(a){}}async function h(a){await e(a,{pricingStatus:"rejected"});try{await d({type:"system",title:"Pricing Rejected",message:`Pricing rejected for order ${a}`,role:"technician",orderId:a,link:"/technician/orders"})}catch(a){}}async function i(a,c,f){let g={counterPrice:f.counterPrice??null,counterDurationMinutes:f.counterDurationMinutes??null,counterArrivalETA:f.counterArrivalETA??null,approvedByAdminId:c,counterByAdminId:c,counterAt:(0,b.serverTimestamp)(),pricingStatus:"countered",proposalNote:f.counterNote??null};await e(a,g);try{await d({type:"system",title:"Counter Offer",message:`Counter offer posted for order ${a}`,role:"technician",orderId:a,link:"/technician/orders"})}catch(a){}}async function j(a,d){let f=(0,b.doc)(c.db,"orders",a),g=await (0,b.getDoc)(f);if(!g.exists())throw Error("Order not found");let h=g.data();if("assigned"!==h.status||h.technicianId&&h.technicianId!==d)throw Error("Not allowed to accept");await e(a,{status:"accepted"})}async function k(a,f){let g=(0,b.doc)(c.db,"orders",a),h=await (0,b.getDoc)(g);if(!h.exists())throw Error("Order not found");let i=h.data();if("countered"!==i.pricingStatus||i.technicianId&&i.technicianId!==f)throw Error("Not allowed to re-accept");await e(a,{pricingStatus:"re_accepted"});try{await d({type:"system",title:"Counter Offer Accepted",message:`Technician accepted counter offer for order ${a}`,role:"admin",orderId:a,link:"/admin/orders"})}catch(a){}}async function l(a,d){let f=(0,b.doc)(c.db,"orders",a),g=await (0,b.getDoc)(f);if(!g.exists())throw Error("Order not found");let h=g.data();if("approved"!==h.pricingStatus||h.technicianId&&h.technicianId!==d)throw Error("Cannot start work");await e(a,{status:"in_progress"})}a.s(["acceptAssignedOrder",()=>j,"approveOrderPricing",()=>g,"counterOfferPricing",()=>i,"proposeOrderPricing",()=>f,"reAcceptCounterOffer",()=>k,"rejectOrderPricing",()=>h,"startWork",()=>l],30003)}];

//# sourceMappingURL=_70fa773d._.js.map